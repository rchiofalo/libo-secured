%=============================================================================
%
%                     PLAIN-PAPER MEMORANDUM FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 10, Para 3
%   - Figure 10-3
%
% What It's For:
%   Informal internal correspondence — more flexible than printed form
%   when you have multiple addressees or via addressees.
%
% Requirements:
%   - Paper: White bond (NO letterhead)
%   - Date: 6th line from top, flush RIGHT margin
%   - ID symbols: Date only (unless local practice requires more)
%   - Signature: Name only — full signature line NOT required
%
%=============================================================================


%=============================================================================
%                          DATE AND MEMO TITLE
%=============================================================================
% Date on line 6, right margin
% "MEMORANDUM" at left margin (not "MEMORANDUM FOR THE RECORD")

\newcommand{\printDateAndTitle}{%
    \hfill \DocumentDate\\[12pt]
    \noindent MEMORANDUM\\[12pt]
}


%=============================================================================
%              FROM / TO / VIA / SUBJ BLOCK (Plain-Paper Style)
%=============================================================================
% - From: line with sender
% - To: line with primary addressee (additional addressees aligned below)
% - Via: line (if applicable)
% - Subj: in ALL CAPS

\newcommand{\printAddressBlock}{%
    \noindent
    \begin{tabular}[t]{@{}l@{\hspace{1em}}p{5.5in}@{}}
        From: & \FromLine\ifdefempty{\FromLineTwo}{}{\tabularnewline & \FromLineTwo}\ifdefempty{\FromLineThree}{}{\tabularnewline & \FromLineThree}\ifdefempty{\FromLineFour}{}{\tabularnewline & \FromLineFour}\tabularnewline
        To: & \ToLine\ifdefempty{\ToLineTwo}{}{\tabularnewline & \ToLineTwo}\ifdefempty{\ToLineThree}{}{\tabularnewline & \ToLineThree}\ifdefempty{\ToLineFour}{}{\tabularnewline & \ToLineFour}\tabularnewline
        \ifViaEnabled
            Via: & \ViaLineOne\ifdefempty{\ViaLineTwo}{}{\tabularnewline & \ViaLineTwo}\ifdefempty{\ViaLineThree}{}{\tabularnewline & \ViaLineThree}\ifdefempty{\ViaLineFour}{}{\tabularnewline & \ViaLineFour}\tabularnewline
        \fi
        & \tabularnewline[-6pt]
        Subj: & \SubjectLine\tabularnewline
    \end{tabular}%
    %
    % CUI block
    \ifCUIEnabled
        \\[12pt]%
        \noindent
        Controlled by: \CUIControlledBy\\
        CUI Category: \CUICategory\\
        Limited Dissemination Control: \CUIDissemination\\
        POC: \href{mailto:\POCEmail}{\POCEmail}%
        \\[12pt]%
        \noindent\CUIDistStatement
    \fi
    %
    % Classified block
    \ifClassifiedEnabled
        \\[12pt]%
        \noindent
        Classified by: \ClassifiedBy\\
        Derived from: \DerivedFrom\\
        Reason: \ClassificationReason\\
        Declassify on: \DeclassifyOn\\
        POC: \href{mailto:\POCEmail}{\POCEmail}
    \fi
}


%=============================================================================
%                  SIGNATURE BLOCK (Plain-Paper Memo Style)
%=============================================================================
% Signature is name only — NO rank, NO organizational title
% Per SECNAV Ch 10, Para 3

\newcommand{\printSignature}{%
    \vspace{36pt}%
    \hspace{3.25in}%
    \begin{minipage}{3in}
        \raggedright
        % Optional: Signature image
        \ifNotEmpty{\SignatureImage}{%
            \IfFileExists{attachments/\SignatureImage}{%
                \includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\SignatureImage}\\[6pt]%
            }{}%
        }%
        % Required: Name only (abbreviated format preferred)
        \ifNotEmptyElse{\SignatoryAbbrev}{\SignatoryAbbrev}{\MakeUppercase{\SignatoryName}}%
    \end{minipage}
}


%=============================================================================
%                         LETTERHEAD OVERRIDE
%=============================================================================
% Plain-paper memo does NOT use letterhead

\renewcommand{\printLetterhead}{}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\fancypagestyle{documentpage}{%
    \fancyhf{}%
    \fancyhead[C]{\placeClassificationMarkings}%
    \fancyfoot[C]{\thepage\ of \pageref{LastPage}}%
    \renewcommand{\headrulewidth}{0pt}%
    \renewcommand{\footrulewidth}{0pt}%
}
