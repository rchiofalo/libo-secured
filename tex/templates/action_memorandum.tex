%=============================================================================
%
%                   ACTION MEMORANDUM FORMAT MODULE
%                        (Executive - HqDON/OSD)
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 12, Para 12-4.3
%
% What It's For:
%   Forward material requiring approval/signature; recommend solutions.
%
% Key Characteristics:
%   - Length: One page (unless complex)
%   - Style: Short, concise bullet statements (black dot preferred)
%   - Font: Times New Roman, 12-point
%   - Margins: 2" top first page (may reduce to 1.75"), 1" sides/bottom
%   - Spacing: Double space between headings and bullets
%   - Page numbers: Bottom center, starting page 2
%   - Assembly: Do NOT staple or use clam clips
%
%=============================================================================


%=============================================================================
%                         FONT OVERRIDE
%=============================================================================
% Executive memos use Times New Roman, not Courier
% Note: \usepackage{times} is already loaded in main.tex preamble

\renewcommand{\familydefault}{\rmdefault}


%=============================================================================
%                    MEMORANDUM FOR ADDRESSEE
%=============================================================================

\newcommand{\MemorandumForAddressee}{}
\newcommand{\setMemorandumForAddressee}[1]{\renewcommand{\MemorandumForAddressee}{#1}}


%=============================================================================
%                    ACTION MEMO FIELDS
%=============================================================================

\newcommand{\ActionFrom}{}
\newcommand{\setActionFrom}[1]{\renewcommand{\ActionFrom}{#1}}

\newcommand{\ActionSubject}{}
\newcommand{\setActionSubject}[1]{\renewcommand{\ActionSubject}{#1}}


%=============================================================================
%                    DATE AND MEMO TITLE
%=============================================================================

\newcommand{\printDateAndTitle}{%
    % SECNAV Ch 12: 2" top margin on first page (1" from geometry + 1" here)
    \vspace*{1in}%
    \begin{center}
        \textbf{ACTION MEMO}
    \end{center}
    \vspace{12pt}%
    \hfill \DocumentDate\\[24pt]
    \noindent MEMORANDUM FOR \MemorandumForAddressee\\[12pt]
}


%=============================================================================
%                       FROM / SUBJECT BLOCK
%=============================================================================

\newcommand{\printAddressBlock}{%
    \noindent
    \begin{tabular}[t]{@{}l@{\hspace{1em}}p{5.5in}@{}}
        FROM: & \ActionFrom\tabularnewline
        & \tabularnewline[-6pt]
        SUBJECT: & \SubjectLine\tabularnewline
    \end{tabular}%
    %
    % CUI block
    \ifCUIEnabled
        \par\vspace{12pt}%
        \noindent
        Controlled by: \CUIControlledBy\\
        CUI Category: \CUICategory\\
        Limited Dissemination Control: \CUIDissemination\\
        POC: \href{mailto:\POCEmail}{\POCEmail}%
        \par\vspace{12pt}%
        \noindent\CUIDistStatement
    \fi
}


%=============================================================================
%                SIGNATURE BLOCK (Action Memo Style)
%=============================================================================

\newcommand{\printSignature}{%
    \par\vspace{48pt}%
    \hspace{3.25in}%
    \begin{minipage}{3in}
        \raggedright
        % Optional: Signature image
        \ifNotEmpty{\SignatureImage}{%
            \IfFileExists{attachments/\SignatureImage}{%
                \includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\SignatureImage}\\[6pt]%
            }{}%
        }%
        % Required: Name (use abbreviated if available, else full name uppercased)
        \ifNotEmptyElse{\SignatoryAbbrev}{\SignatoryAbbrev\\}{\MakeUppercase{\SignatoryName}\\}%
        % Optional: Rank
        \optionalLine{\SignatoryRank}%
        % Optional: Title
        \optionalLine{\SignatoryTitle}%
        % Optional: By direction authority line (e.g., "By direction of the Commander")
        \optionalField{\ByDirection}%
    \end{minipage}
}


%=============================================================================
%                         LETTERHEAD OVERRIDE
%=============================================================================

\renewcommand{\printLetterhead}{}


%=============================================================================
%                              PAGE STYLE
%=============================================================================
% First page: NOT numbered
% Page 2+: Bottom center

\fancypagestyle{firstpage}{%
    \fancyhf{}%
    \fancyhead[C]{\placeClassificationMarkings}%
    \renewcommand{\headrulewidth}{0pt}%
    \renewcommand{\footrulewidth}{0pt}%
}

\fancypagestyle{documentpage}{%
    \fancyhf{}%
    \fancyhead[C]{\placeClassificationMarkings}%
    \fancyfoot[C]{\thepage}%
    \renewcommand{\headrulewidth}{0pt}%
    \renewcommand{\footrulewidth}{0pt}%
}
