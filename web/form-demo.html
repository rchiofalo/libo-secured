<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NAVMC 10274 Form Generator Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 { color: #333; }
        .container {
            display: flex;
            gap: 20px;
        }
        .form-inputs {
            flex: 0 0 400px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-height: 90vh;
            overflow-y: auto;
        }
        .preview {
            flex: 1;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        label {
            display: block;
            margin-top: 12px;
            font-weight: 600;
            color: #444;
            font-size: 13px;
        }
        input, textarea {
            width: 100%;
            padding: 8px;
            margin-top: 4px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 13px;
        }
        textarea { resize: vertical; }
        button {
            margin-top: 20px;
            padding: 12px 24px;
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover { background: #0055aa; }
        iframe {
            width: 100%;
            height: 900px;
            border: 1px solid #ccc;
        }
        .note {
            background: #fffbcc;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
            font-size: 13px;
        }
        .btn-row {
            display: flex;
            gap: 10px;
        }
        .btn-row button { flex: 1; }
        .btn-secondary { background: #666; }
    </style>
</head>
<body>
    <h1>NAVMC 10274 - Administrative Action (6105)</h1>
    <p class="note">Generated using pdf-lib with exact XFA layout measurements. Compare with the official form in Adobe Acrobat.</p>

    <div class="container">
        <div class="form-inputs">
            <h3>Form Data</h3>

            <label>1. Action No.</label>
            <input type="text" id="actNum" placeholder="e.g., 001-25">

            <label>2. SSIC/File No.</label>
            <input type="text" id="fileNum" placeholder="e.g., 1070">

            <label>3. Date (YYYY-MM-DD)</label>
            <input type="date" id="date">

            <label>4. From (Grade, Name, EDIPI, MOS or CO, Pers. O., etc.)</label>
            <textarea id="nameFrom" rows="2" placeholder="e.g., Commanding Officer"></textarea>

            <label>5. Organization and Station (Complete address)</label>
            <textarea id="orgStat" rows="3" placeholder="e.g., Marine Corps Base&#10;Camp Pendleton, CA 92055"></textarea>

            <label>6. Via (As required)</label>
            <textarea id="via" rows="2" placeholder="e.g., Executive Officer"></textarea>

            <label>7. To</label>
            <textarea id="addrTo" rows="3" placeholder="e.g., LCpl Smith, John A.&#10;1234567890&#10;0311"></textarea>

            <label>8. Nature of Action/Subject</label>
            <textarea id="natOfAct" rows="2" placeholder="e.g., Administrative Counseling (6105)"></textarea>

            <label>9. Copy To (As required)</label>
            <textarea id="copyTo" rows="2" placeholder="e.g., SgtMaj, 1stSgt"></textarea>

            <label>10. Reference or Authority (if applicable)</label>
            <textarea id="refAuth" rows="2" placeholder="e.g., MCO 1900.16"></textarea>

            <label>11. Enclosures (if any)</label>
            <textarea id="encl" rows="2" placeholder="e.g., (1) Statement of LCpl Smith"></textarea>

            <label>12. Supplemental Information</label>
            <textarea id="suppInfo" rows="6" placeholder="Enter the counseling statement text here..."></textarea>

            <div class="btn-row">
                <button onclick="generatePDF()">Generate PDF</button>
                <button onclick="generateBlankPDF()" class="btn-secondary">Blank Form</button>
            </div>
        </div>

        <div class="preview">
            <h3>PDF Preview</h3>
            <iframe id="pdfPreview"></iframe>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script>
        // Convert mm to points (1mm = 2.83465pt)
        const mm = (val) => val * 2.83465;

        // Original XFA page size: 7.75in Ã— 10.125in
        const PAGE_WIDTH = 7.75 * 72;   // 558pt
        const PAGE_HEIGHT = 10.125 * 72; // 729pt

        // Content area margins from XFA
        const CONTENT_X = mm(9.525);  // ~27pt
        const CONTENT_Y = mm(9.525);
        const CONTENT_W = mm(196.85); // ~558pt (full width minus margins)
        const CONTENT_H = mm(257.175);

        // Border thickness
        const BORDER = 0.5;

        async function createNAVMC10274(data = {}) {
            const { PDFDocument, rgb, StandardFonts } = PDFLib;

            const doc = await PDFDocument.create();
            const arial = await doc.embedFont(StandardFonts.Helvetica);
            const arialBold = await doc.embedFont(StandardFonts.HelveticaBold);
            const times = await doc.embedFont(StandardFonts.TimesRoman);

            const form = doc.getForm();

            // Helper to convert XFA coordinates (mm from top-left of content area) to PDF coordinates (from bottom-left)
            const xfaX = (xMm) => CONTENT_X + mm(xMm);
            const xfaY = (yMm, hMm = 0) => PAGE_HEIGHT - CONTENT_Y - mm(yMm) - mm(hMm);

            // ============ PAGE 1: Privacy Statement ============
            const page1 = doc.addPage([PAGE_WIDTH, PAGE_HEIGHT]);

            // Privacy Act Statement title bar
            const titleBarH = mm(20.433);
            page1.drawRectangle({
                x: xfaX(0),
                y: xfaY(0, 20.433),
                width: mm(197.06),
                height: titleBarH,
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page1.drawText('PRIVACY ACT STATEMENT', {
                x: PAGE_WIDTH / 2 - arialBold.widthOfTextAtSize('PRIVACY ACT STATEMENT', 10) / 2,
                y: xfaY(5),
                size: 10,
                font: arialBold,
            });
            page1.drawText('In accordance with the Privacy Act of 1974 (Public Law 93-579), this notice informs you of the purpose', {
                x: xfaX(1),
                y: xfaY(12),
                size: 8,
                font: arial,
            });
            page1.drawText('for collection of information on this form. Please read it before completing the form.', {
                x: xfaX(1),
                y: xfaY(15),
                size: 8,
                font: arial,
            });

            // Main privacy box
            const privacyBoxY = mm(20.955);
            const privacyBoxH = mm(107.95);
            page1.drawRectangle({
                x: xfaX(0),
                y: xfaY(20.955 + 107.95),
                width: mm(196.777),
                height: privacyBoxH,
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });

            // Privacy text content
            const privacyContent = [
                { bold: true, text: 'Authority:' },
                { bold: false, text: ' 10 U.S.C. 5013; 10 U.S.C. 5041; 10 U.S.C. 1074f; 42 U.S.C. 10606 as implemented by DoDD' },
                { bold: false, text: '1030.1; 32 CFR 64.4; DoDI 1215.13; DoDI 3001.02; CJCSM 3150.13B; DoDI 6490.03; MCMEDS:' },
                { bold: false, text: 'SECNAVINST 1770.3D; MCO 7220.50B; E.O. 9397 (SSN), as amended; and SORNs M01040-3' },
                { bold: false, text: 'and M01070-6.' },
                { bold: false, text: '' },
                { bold: true, text: 'Purpose:' },
                { bold: false, text: ' To be used when no other form is prescribed or no other type of communication is' },
                { bold: false, text: 'required to process and direct request for personnel action.' },
                { bold: false, text: '' },
                { bold: true, text: 'Routine Uses:' },
                { bold: false, text: ' Information will be used by Marine Corps personnel and other military personnel' },
                { bold: false, text: 'attached to Marine Corps commands with a need to know to meet the purpose. A complete list and' },
                { bold: false, text: 'explanation of the applicable routine uses is published in the authorizing SORNs.' },
                { bold: false, text: '' },
                { bold: true, text: 'Disclosure:' },
                { bold: false, text: ' Voluntary; however, failure to provide the requested information may result in request' },
                { bold: false, text: 'being returned or denied.' },
                { bold: false, text: '' },
                { bold: true, text: 'Record Management:' },
                { bold: false, text: ' This form shall be managed in accordance with record schedule 1000-31,' },
                { bold: false, text: '"Active Personnel Records," of SECNAV M-5210.1.' },
            ];

            let lineY = 26;
            for (const line of privacyContent) {
                if (line.text) {
                    page1.drawText(line.text, {
                        x: xfaX(1.5),
                        y: xfaY(lineY),
                        size: 9,
                        font: line.bold ? arialBold : arial,
                    });
                }
                lineY += 4;
            }

            // Footer
            page1.drawText('NAVMC 10274 (REV. 07-20) (EF)', {
                x: xfaX(0),
                y: mm(8),
                size: 8,
                font: arial,
            });
            page1.drawText('Previous editions will not be used', {
                x: xfaX(0),
                y: mm(5),
                size: 6,
                font: arial,
            });

            // ============ PAGE 2: Main Form ============
            const page2 = doc.addPage([PAGE_WIDTH, PAGE_HEIGHT]);

            // Title bar: ADMINISTRATIVE ACTION (5216) - full width, h=9.948mm
            const titleH = mm(9.948);
            page2.drawRectangle({
                x: xfaX(0),
                y: xfaY(0, 9.948),
                width: mm(197.06),
                height: titleH,
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('ADMINISTRATIVE ACTION (5216)', {
                x: PAGE_WIDTH / 2 - arialBold.widthOfTextAtSize('ADMINISTRATIVE ACTION (5216)', 10) / 2,
                y: xfaY(6.5),
                size: 10,
                font: arialBold,
            });
            // MCO reference in top right
            page2.drawText('MCO 5216.19A', {
                x: xfaX(184),
                y: PAGE_HEIGHT - mm(6),
                size: 8,
                font: arial,
            });

            // Row 1: Action No (x=133.35, y=9.948, w=28.575, h=9.525)
            const actNumX = 133.35, actNumY = 9.948, actNumW = 28.575, actNumH = 9.525;
            page2.drawRectangle({
                x: xfaX(actNumX),
                y: xfaY(actNumY + actNumH),
                width: mm(actNumW),
                height: mm(actNumH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('1.  ACTION NO.', {
                x: xfaX(actNumX + 0.8),
                y: xfaY(actNumY + 3),
                size: 8,
                font: arial,
            });
            const actNumField = form.createTextField('ActNum');
            actNumField.addToPage(page2, {
                x: xfaX(actNumX + 0.8),
                y: xfaY(actNumY + actNumH - 1),
                width: mm(actNumW - 1.5),
                height: mm(5),
            });
            actNumField.setFontSize(9);
            if (data.actNum) actNumField.setText(data.actNum);

            // File No (x=161.925, y=9.948, w=34.925, h=9.525)
            const fileNumX = 161.925, fileNumW = 34.925;
            page2.drawRectangle({
                x: xfaX(fileNumX),
                y: xfaY(actNumY + actNumH),
                width: mm(fileNumW),
                height: mm(actNumH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('2.  SSIC/FILE NO.', {
                x: xfaX(fileNumX + 0.8),
                y: xfaY(actNumY + 3),
                size: 8,
                font: arial,
            });
            const fileNumField = form.createTextField('FileNum');
            fileNumField.addToPage(page2, {
                x: xfaX(fileNumX + 0.8),
                y: xfaY(actNumY + actNumH - 1),
                width: mm(fileNumW - 1.5),
                height: mm(5),
            });
            fileNumField.setFontSize(9);
            if (data.fileNum) fileNumField.setText(data.fileNum);

            // Date (x=133.35, y=19.473, w=63.5, h=9.102)
            const dateX = 133.35, dateY = 19.473, dateW = 63.5, dateH = 9.102;
            page2.drawRectangle({
                x: xfaX(dateX),
                y: xfaY(dateY + dateH),
                width: mm(dateW),
                height: mm(dateH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('3.  DATE', {
                x: xfaX(dateX + 0.8),
                y: xfaY(dateY + 3),
                size: 8,
                font: arial,
            });
            const dateField = form.createTextField('Date');
            dateField.addToPage(page2, {
                x: xfaX(dateX + 0.8),
                y: xfaY(dateY + dateH - 1),
                width: mm(dateW - 1.5),
                height: mm(5),
            });
            dateField.setFontSize(9);
            if (data.date) dateField.setText(data.date);

            // FROM (x=0.298, y=28.759, w=98.549, h=12.7)
            const fromX = 0.298, fromY = 28.759, fromW = 98.549, fromH = 12.7;
            page2.drawRectangle({
                x: xfaX(fromX),
                y: xfaY(fromY + fromH),
                width: mm(fromW),
                height: mm(fromH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('4.  FROM (Grade, Name, EDIPI, MOS or CO, Pers. O., etc.)', {
                x: xfaX(fromX + 0.8),
                y: xfaY(fromY + 3),
                size: 8,
                font: arial,
            });
            const nameFromField = form.createTextField('NameFrom');
            nameFromField.addToPage(page2, {
                x: xfaX(fromX + 0.8),
                y: xfaY(fromY + fromH - 1),
                width: mm(fromW - 1.5),
                height: mm(fromH - 4),
            });
            nameFromField.setFontSize(9);
            nameFromField.enableMultiline();
            if (data.nameFrom) nameFromField.setText(data.nameFrom);

            // ORG/STATION (x=98.847, y=28.575, w=98.113, h=25.4)
            const orgX = 98.847, orgY = 28.575, orgW = 98.113, orgH = 25.4;
            page2.drawRectangle({
                x: xfaX(orgX),
                y: xfaY(orgY + orgH),
                width: mm(orgW),
                height: mm(orgH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('5.  ORGANIZATION AND STATION (Complete address)', {
                x: xfaX(orgX + 0.8),
                y: xfaY(orgY + 3.5),
                size: 8,
                font: arial,
            });
            const orgStatField = form.createTextField('OrgStat');
            orgStatField.addToPage(page2, {
                x: xfaX(orgX + 0.8),
                y: xfaY(orgY + orgH - 1),
                width: mm(orgW - 1.5),
                height: mm(orgH - 5),
            });
            orgStatField.setFontSize(9);
            orgStatField.enableMultiline();
            if (data.orgStat) orgStatField.setText(data.orgStat);

            // VIA (x=0.11, y=41.275, w=98.737, h=12.7)
            const viaX = 0.11, viaY = 41.275, viaW = 98.737, viaH = 12.7;
            page2.drawRectangle({
                x: xfaX(viaX),
                y: xfaY(viaY + viaH),
                width: mm(viaW),
                height: mm(viaH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('6.  VIA (As required)', {
                x: xfaX(viaX + 0.8),
                y: xfaY(viaY + 3),
                size: 8,
                font: arial,
            });
            const viaField = form.createTextField('Via');
            viaField.addToPage(page2, {
                x: xfaX(viaX + 0.8),
                y: xfaY(viaY + viaH - 1),
                width: mm(viaW - 1.5),
                height: mm(viaH - 4),
            });
            viaField.setFontSize(9);
            viaField.enableMultiline();
            if (data.via) viaField.setText(data.via);

            // TO box with "7." label (x=0.11, y=53.975, w=114.3, h=34.925)
            const toBoxX = 0.11, toBoxY = 53.975, toBoxW = 114.3, toBoxH = 34.925;
            page2.drawRectangle({
                x: xfaX(toBoxX),
                y: xfaY(toBoxY + toBoxH),
                width: mm(toBoxW),
                height: mm(toBoxH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('7.', {
                x: xfaX(toBoxX + 1),
                y: xfaY(toBoxY + 3),
                size: 8,
                font: arial,
            });
            page2.drawText('TO:', {
                x: xfaX(toBoxX + 5),
                y: xfaY(toBoxY + 20),
                size: 8,
                font: arial,
            });

            // AddrTo field (x=12.81, y=57.15, w=95.25, h=28.575)
            const addrToX = 12.81, addrToY = 57.15, addrToW = 95.25, addrToH = 28.575;
            const addrToField = form.createTextField('AddrTo');
            addrToField.addToPage(page2, {
                x: xfaX(addrToX),
                y: xfaY(addrToY + addrToH),
                width: mm(addrToW),
                height: mm(addrToH),
            });
            addrToField.setFontSize(10);
            addrToField.enableMultiline();
            if (data.addrTo) addrToField.setText(data.addrTo);

            // Nature of Action (x=114.41, y=53.975, w=82.55, h=19.05)
            const natX = 114.41, natY = 53.975, natW = 82.55, natH = 19.05;
            page2.drawRectangle({
                x: xfaX(natX),
                y: xfaY(natY + natH),
                width: mm(natW),
                height: mm(natH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('8.  NATURE OF ACTION/SUBJECT', {
                x: xfaX(natX + 0.8),
                y: xfaY(natY + 3),
                size: 8,
                font: arial,
            });
            const natOfActField = form.createTextField('NatOfAct');
            natOfActField.addToPage(page2, {
                x: xfaX(natX + 0.8),
                y: xfaY(natY + natH - 1),
                width: mm(natW - 1.5),
                height: mm(natH - 4.5),
            });
            natOfActField.setFontSize(9);
            natOfActField.enableMultiline();
            if (data.natOfAct) natOfActField.setText(data.natOfAct);

            // Copy To (x=114.41, y=73.025, w=82.55, h=15.875)
            const copyX = 114.41, copyY = 73.025, copyW = 82.55, copyH = 15.875;
            page2.drawRectangle({
                x: xfaX(copyX),
                y: xfaY(copyY + copyH),
                width: mm(copyW),
                height: mm(copyH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('9.  COPY TO (As required)', {
                x: xfaX(copyX + 0.8),
                y: xfaY(copyY + 3),
                size: 8,
                font: arial,
            });
            const copyToField = form.createTextField('CopyTo');
            copyToField.addToPage(page2, {
                x: xfaX(copyX + 0.8),
                y: xfaY(copyY + copyH - 1),
                width: mm(copyW - 1.5),
                height: mm(copyH - 4.5),
            });
            copyToField.setFontSize(9);
            copyToField.enableMultiline();
            if (data.copyTo) copyToField.setText(data.copyTo);

            // Reference (x=0.11, y=88.9, w=98.425, h=31.75)
            const refX = 0.11, refY = 88.9, refW = 98.425, refH = 31.75;
            page2.drawRectangle({
                x: xfaX(refX),
                y: xfaY(refY + refH),
                width: mm(refW),
                height: mm(refH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('10.  REFERENCE OR AUTHORITY (if applicable)', {
                x: xfaX(refX + 0.8),
                y: xfaY(refY + 3.5),
                size: 8,
                font: arial,
            });
            const refAuthField = form.createTextField('RefAuth');
            refAuthField.addToPage(page2, {
                x: xfaX(refX + 0.8),
                y: xfaY(refY + refH - 1),
                width: mm(refW - 1.5),
                height: mm(refH - 5),
            });
            refAuthField.setFontSize(9);
            refAuthField.enableMultiline();
            if (data.refAuth) refAuthField.setText(data.refAuth);

            // Enclosures (x=98.535, y=88.9, w=98.425, h=31.75)
            const enclX = 98.535, enclY = 88.9, enclW = 98.425, enclH = 31.75;
            page2.drawRectangle({
                x: xfaX(enclX),
                y: xfaY(enclY + enclH),
                width: mm(enclW),
                height: mm(enclH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('11.  ENCLOSURES (if any)', {
                x: xfaX(enclX + 0.8),
                y: xfaY(enclY + 3),
                size: 8,
                font: arial,
            });
            const enclField = form.createTextField('Encl');
            enclField.addToPage(page2, {
                x: xfaX(enclX + 0.8),
                y: xfaY(enclY + enclH - 1),
                width: mm(enclW - 1.5),
                height: mm(enclH - 5),
            });
            enclField.setFontSize(9);
            enclField.enableMultiline();
            if (data.encl) enclField.setText(data.encl);

            // Supplemental Info (x=0, y=120.86, w=196.96, h=129.965)
            const suppX = 0, suppY = 120.86, suppW = 196.96, suppH = 129.965;
            page2.drawRectangle({
                x: xfaX(suppX),
                y: xfaY(suppY + suppH),
                width: mm(suppW),
                height: mm(suppH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('12.  SUPPLEMENTAL INFORMATION (Reduce to minimum wording - type name of originator and sign 3 lines below text)', {
                x: xfaX(suppX + 0.8),
                y: xfaY(suppY + 3.5),
                size: 8,
                font: arial,
            });
            const suppInfoField = form.createTextField('SuppInfo');
            suppInfoField.addToPage(page2, {
                x: xfaX(suppX + 0.8),
                y: xfaY(suppY + suppH - 1),
                width: mm(suppW - 1.5),
                height: mm(suppH - 5),
            });
            suppInfoField.setFontSize(10);
            suppInfoField.enableMultiline();
            if (data.suppInfo) suppInfoField.setText(data.suppInfo);

            // Processing Action header (x=0.11, y=250.825, w=196.85, h=6.35)
            const procHdrX = 0.11, procHdrY = 250.825, procHdrW = 196.85, procHdrH = 6.35;
            page2.drawRectangle({
                x: xfaX(procHdrX),
                y: xfaY(procHdrY + procHdrH),
                width: mm(procHdrW),
                height: mm(procHdrH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            page2.drawText('13.  PROCESSING ACTION.  (Complete processing action in item 12 or on reverse.  Endorse by rubber stamp where practicable.)', {
                x: xfaX(procHdrX + 1),
                y: xfaY(procHdrY + 4),
                size: 8,
                font: arial,
            });

            // Page 2 footer
            page2.drawText('NAVMC 10274 (REV. 07-20) (EF)', {
                x: xfaX(0),
                y: mm(8),
                size: 8,
                font: arial,
            });
            page2.drawText('Previous editions will not be used', {
                x: xfaX(0),
                y: mm(5),
                size: 6,
                font: arial,
            });
            page2.drawText('FOR OFFICIAL USE ONLY', {
                x: PAGE_WIDTH / 2 - arialBold.widthOfTextAtSize('FOR OFFICIAL USE ONLY', 7) / 2,
                y: mm(6),
                size: 7,
                font: arialBold,
            });
            page2.drawText('PRIVACY SENSITIVE - Any misuse or unauthorized', {
                x: PAGE_WIDTH / 2 - arial.widthOfTextAtSize('PRIVACY SENSITIVE - Any misuse or unauthorized', 7) / 2,
                y: mm(3.5),
                size: 7,
                font: arial,
            });
            page2.drawText('Page 1 of 2', {
                x: PAGE_WIDTH - mm(20),
                y: mm(5),
                size: 8,
                font: arial,
            });

            // ============ PAGE 3: Processing Action Continuation ============
            const page3 = doc.addPage([PAGE_WIDTH, PAGE_HEIGHT]);

            // Title
            page3.drawText('ADMINISTRATIVE ACTION (5216)', {
                x: PAGE_WIDTH / 2 - arialBold.widthOfTextAtSize('ADMINISTRATIVE ACTION (5216)', 10) / 2,
                y: PAGE_HEIGHT - mm(8),
                size: 10,
                font: arialBold,
            });

            // Processing Action box (x=0, y=12.7, w=196.85, h=244.475)
            const procX = 0, procY = 12.7, procW = 196.85, procH = 244.475;
            page3.drawRectangle({
                x: xfaX(procX),
                y: xfaY(procY + procH),
                width: mm(procW),
                height: mm(procH),
                borderColor: rgb(0, 0, 0),
                borderWidth: BORDER,
            });
            const procActField = form.createTextField('ProcAct');
            procActField.addToPage(page3, {
                x: xfaX(procX + 0.8),
                y: xfaY(procY + procH - 1),
                width: mm(procW - 1.5),
                height: mm(procH - 2),
            });
            procActField.setFontSize(10);
            procActField.enableMultiline();

            // Page 3 footer
            page3.drawText('NAVMC 10274 (REV. 07-20) (EF)', {
                x: xfaX(0),
                y: mm(8),
                size: 8,
                font: arial,
            });
            page3.drawText('FOR OFFICIAL USE ONLY', {
                x: PAGE_WIDTH / 2 - arialBold.widthOfTextAtSize('FOR OFFICIAL USE ONLY', 7) / 2,
                y: mm(6),
                size: 7,
                font: arialBold,
            });
            page3.drawText('Page 2 of 2', {
                x: PAGE_WIDTH - mm(20),
                y: mm(5),
                size: 8,
                font: arial,
            });

            return await doc.save();
        }

        async function generatePDF() {
            const data = {
                actNum: document.getElementById('actNum').value,
                fileNum: document.getElementById('fileNum').value,
                date: document.getElementById('date').value,
                nameFrom: document.getElementById('nameFrom').value,
                orgStat: document.getElementById('orgStat').value,
                via: document.getElementById('via').value,
                addrTo: document.getElementById('addrTo').value,
                natOfAct: document.getElementById('natOfAct').value,
                copyTo: document.getElementById('copyTo').value,
                refAuth: document.getElementById('refAuth').value,
                encl: document.getElementById('encl').value,
                suppInfo: document.getElementById('suppInfo').value,
            };

            const pdfBytes = await createNAVMC10274(data);
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            document.getElementById('pdfPreview').src = url;
        }

        async function generateBlankPDF() {
            const pdfBytes = await createNAVMC10274({});
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            document.getElementById('pdfPreview').src = url;
        }

        // Generate blank form on load
        window.onload = generateBlankPDF;
    </script>
</body>
</html>
