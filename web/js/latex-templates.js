/**
 * LaTeX Templates for SwiftLaTeX Browser Compilation
 * Auto-generated by build-templates.sh - DO NOT EDIT
 * Generated: Wed Dec 31 15:51:08 PST 2025
 */

const LATEX_TEMPLATES = {
  'tex/main.tex': `
%=============================================================================
%
%                 USMC CORRESPONDENCE TEMPLATE (Modular Architecture)
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual)
%   - MCO 5216.20B w/Admin CH-4 (Marine Corps Supplement)
%   - DoDI 5200.48 (CUI marking requirements)
%
% Supported Document Types:
%
%   LETTERS:
%   - standard_letter           Standard Letter (Ch 2) - plain bond
%   - naval_letter              Naval Letter (Ch 2) - on letterhead
%   - business_letter           Business Letter (Ch 11)
%   - multiple_address_letter   Multiple-Address Letter (Ch 8)
%   - same_page_endorsement     Same-Page Endorsement (Ch 9)
%   - new_page_endorsement      New-Page Endorsement (Ch 9)
%   - joint_letter              Joint Letter (Ch 7)
%   - joint_memorandum          Joint Memorandum (Ch 7)
%
%   MEMORANDUMS:
%   - mfr                       Memorandum for the Record (Ch 10, Para 1)
%   - plain_paper_memorandum    Plain-Paper Memorandum (Ch 10, Para 3)
%   - letterhead_memorandum     Letterhead Memorandum (Ch 10, Para 4)
%   - decision_memorandum       Decision Memorandum (Ch 10, Para 5)
%   - moa                       Memorandum of Agreement (Ch 10, Para 6)
%   - mou                       Memorandum of Understanding (Ch 10, Para 6)
%   - from_to_memorandum        From-To Memorandum (Ch 10, Para 2) - TODO
%
%   EXECUTIVE MEMORANDUMS (HqDON/OSD):
%   - standard_memorandum       Standard Memorandum (Ch 12)
%   - action_memorandum         Action Memorandum (Ch 12)
%   - information_memorandum    Information Memorandum (Ch 12)
%
%   USMC-SPECIFIC:
%   - mf                        "Memorandum For" (MCO 5216.20B)
%
% CONFIGURATION:
%   Edit files in the tex/ folder:
%   - document.tex       - Document type, SSIC, Date, From, To, Via, Subject
%   - letterhead.tex     - Unit name and address
%   - classification.tex - CUI markings and distribution
%   - signatory.tex      - Signature block (full and abbreviated)
%   - references.tex     - Reference list
%   - reference-urls.tex - Clickable URLs for references
%   - enclosures.tex     - Enclosure list (PDFs go in enclosures/ folder)
%   - body.tex           - Document body content
%
% Format-specific code is in the templates/ folder
%
%=============================================================================


\\documentclass[12pt, letterpaper]{article}


%=============================================================================
%                              PACKAGE IMPORTS
%=============================================================================

%-----------------------------------------------------------------------------
% SWIFTLATEX COMPATIBILITY - MUST BE LOADED FIRST
%-----------------------------------------------------------------------------
% Provides LaTeX 2020-10-01 features for older 2020-02-02 SwiftLaTeX format
%-----------------------------------------------------------------------------
\\usepackage{swiftlatex-compat}

%-----------------------------------------------------------------------------
% PAGE GEOMETRY - SECNAV M-5216.5 COMPLIANT
%-----------------------------------------------------------------------------
% Chapter 7-2(1): "Allow 1-inch top, bottom, left, and right margins"
% Chapter 7-16: "Center page numbers 1/2 inch from the bottom edge"
%-----------------------------------------------------------------------------

\\usepackage[
    letterpaper,
    top     = 1in,
    bottom  = 1in,
    left    = 1in,
    right   = 1in,
    headheight = 15pt,
    headsep    = 0pt,
    footskip   = 0.5in
]{geometry}


%-----------------------------------------------------------------------------
% FONTS AND ENCODING
%-----------------------------------------------------------------------------
% Note: Using default OT1 encoding with Computer Modern fonts for SwiftLaTeX
% T1 encoding requires EC fonts which are not bundled

\\usepackage{courier}
\\usepackage{times}


%-----------------------------------------------------------------------------
% HEADERS, FOOTERS, AND PAGE NUMBERING
%-----------------------------------------------------------------------------

\\usepackage{fancyhdr}
\\usepackage{lastpage}

%-----------------------------------------------------------------------------
% Page Numbering Style Configuration
%-----------------------------------------------------------------------------
% Options:
%   simple  - No number on page 1, then "2", "3", "4"...
%   xofy    - "1 of X", "2 of X", "3 of X"... (default)
%   none    - No page numbers at all
%-----------------------------------------------------------------------------

\\newcommand{\\PageNumberStyle}{xofy}
\\newcommand{\\setPageNumberStyle}[1]{\\renewcommand{\\PageNumberStyle}{#1}}

% Smart page numbering based on style setting
\\makeatletter
\\newcommand{\\smartPageNumber}{%
    \\ifthenelse{\\equal{\\PageNumberStyle}{none}}{%
        % No page numbers
    }{%
        \\ifthenelse{\\equal{\\PageNumberStyle}{simple}}{%
            % Simple style: no number on page 1, then 2, 3, 4...
            \\ifnum\\value{page}>1
                \\thepage
            \\fi
        }{%
            % X of Y style (default)
            \\@ifundefined{r@LastPage}{%
                % LastPage not defined yet (first pass) - show just page number
                \\thepage
            }{%
                % LastPage defined - show "X of Y"
                \\thepage\\ of \\pageref{LastPage}%
            }%
        }%
    }%
}
\\makeatother


%-----------------------------------------------------------------------------
% GRAPHICS AND COLORS
%-----------------------------------------------------------------------------

\\usepackage{graphicx}
\\usepackage{xcolor}


%-----------------------------------------------------------------------------
% ABSOLUTE POSITIONING (for CUI markings)
%-----------------------------------------------------------------------------

\\usepackage[absolute, overlay]{textpos}
\\setlength{\\TPHorizModule}{1in}
\\setlength{\\TPVertModule}{1in}


%-----------------------------------------------------------------------------
% LISTS AND ENUMERATION
%-----------------------------------------------------------------------------

\\usepackage{enumitem}


%-----------------------------------------------------------------------------
% HYPERLINKS
%-----------------------------------------------------------------------------

\\usepackage{hyperref}

\\hypersetup{
    colorlinks  = true,
    linkcolor   = blue,
    urlcolor    = blue,
    pdfborder   = {0 0 0},
}


%-----------------------------------------------------------------------------
% SPACING AND PARAGRAPHS
%-----------------------------------------------------------------------------

\\usepackage{setspace}
\\usepackage{parskip}


%-----------------------------------------------------------------------------
% TABLES
%-----------------------------------------------------------------------------

\\usepackage{tabularx}
\\usepackage{array}


%-----------------------------------------------------------------------------
% UTILITIES
%-----------------------------------------------------------------------------

\\usepackage{calc}
\\usepackage{ifthen}


%-----------------------------------------------------------------------------
% PDF INCLUSION (for enclosures)
%-----------------------------------------------------------------------------

\\usepackage{pdfpages}


%=============================================================================
%                           FONT CONFIGURATION
%=============================================================================
%
% SECNAV M-5216.5:
%   Chapter 2-20: "Courier New 12-point is the preferred font style and size"
%   Chapter 7-2(1): "Do not right, center, or full justify text"
%
%=============================================================================

% Default font settings (can be overridden by config/document.tex)
\\newcommand{\\FontSize}{12pt}
\\newcommand{\\FontFamily}{courier}

% Commands to set font options from config
\\newcommand{\\setFontSize}[1]{\\renewcommand{\\FontSize}{#1}}
\\newcommand{\\setFontFamily}[1]{\\renewcommand{\\FontFamily}{#1}}

% Apply font family (called after config is loaded)
\\newcommand{\\applyFontSettings}{%
    \\ifthenelse{\\equal{\\FontFamily}{times}}{%
        \\renewcommand{\\familydefault}{\\rmdefault}%
    }{%
        \\renewcommand{\\familydefault}{\\ttdefault}%
    }%
    % Apply font size
    \\ifthenelse{\\equal{\\FontSize}{10pt}}{%
        \\fontsize{10pt}{12pt}\\selectfont%
    }{%
        \\fontsize{12pt}{14.4pt}\\selectfont%
    }%
}

% Default to Courier (applied initially, may be overridden)
\\renewcommand{\\familydefault}{\\ttdefault}
\\linespread{1.0}
\\raggedright

% MCO 5216.20B Section 2, para 1.a: PMS 288 blue for letterhead
\\definecolor{navyblue}{RGB}{0, 32, 91}


%=============================================================================
%                         PARAGRAPH FORMATTING
%=============================================================================

\\setlength{\\parindent}{0in}
\\setlength{\\parskip}{0pt}  % Format modules control their own spacing


%=============================================================================
%                      DOCUMENT TYPE CONFIGURATION
%=============================================================================

\\newcommand{\\DocumentType}{}
\\newcommand{\\setDocumentType}[1]{\\renewcommand{\\DocumentType}{#1}}


%=============================================================================
%                       CLASSIFICATION CONFIGURATION
%=============================================================================


%-----------------------------------------------------------------------------
% Classification Toggles
%-----------------------------------------------------------------------------

\\newif\\ifClassificationEnabled
\\ClassificationEnabledfalse

\\newif\\ifCUIEnabled
\\CUIEnabledfalse

\\newif\\ifClassifiedEnabled
\\ClassifiedEnabledfalse


%-----------------------------------------------------------------------------
% Classification Marking (shown in header/footer)
%-----------------------------------------------------------------------------

\\newcommand{\\ClassificationMarking}{}


%-----------------------------------------------------------------------------
% CUI-Specific Fields
%-----------------------------------------------------------------------------

\\newcommand{\\CUIControlledBy}{}
\\newcommand{\\CUICategory}{}
\\newcommand{\\CUIDissemination}{}
\\newcommand{\\CUIDistStatement}{}


%-----------------------------------------------------------------------------
% Classified-Specific Fields
%-----------------------------------------------------------------------------

\\newcommand{\\ClassifiedBy}{}
\\newcommand{\\DerivedFrom}{}
\\newcommand{\\DeclassifyOn}{}
\\newcommand{\\ClassificationReason}{}


%-----------------------------------------------------------------------------
% Classification Level Setter
%-----------------------------------------------------------------------------

\\newcommand{\\setClassification}[1]{%
    \\renewcommand{\\ClassificationMarking}{#1}%
    \\ClassificationEnabledtrue
    \\def\\tmpCUI{CUI}%
    \\def\\tmpArg{#1}%
    \\ifx\\tmpArg\\tmpCUI
        \\CUIEnabledtrue
    \\else
        \\ClassifiedEnabledtrue
    \\fi
}


%-----------------------------------------------------------------------------
% CUI Field Setters
%-----------------------------------------------------------------------------

\\newcommand{\\setCUIControlledBy}[1]{\\renewcommand{\\CUIControlledBy}{#1}}
\\newcommand{\\setCUICategory}[1]{\\renewcommand{\\CUICategory}{#1}}
\\newcommand{\\setCUIDissemination}[1]{\\renewcommand{\\CUIDissemination}{#1}}
\\newcommand{\\setCUIDistStatement}[1]{\\renewcommand{\\CUIDistStatement}{#1}}


%-----------------------------------------------------------------------------
% Classified Field Setters
%-----------------------------------------------------------------------------

\\newcommand{\\setClassifiedBy}[1]{\\renewcommand{\\ClassifiedBy}{#1}}
\\newcommand{\\setDerivedFrom}[1]{\\renewcommand{\\DerivedFrom}{#1}}
\\newcommand{\\setDeclassifyOn}[1]{\\renewcommand{\\DeclassifyOn}{#1}}
\\newcommand{\\setClassificationReason}[1]{\\renewcommand{\\ClassificationReason}{#1}}


%=============================================================================
%                        DOCUMENT METADATA COMMANDS
%=============================================================================


%-----------------------------------------------------------------------------
% SSIC (Standard Subject Identification Code)
%-----------------------------------------------------------------------------

\\newcommand{\\DocumentSSIC}{}
\\newcommand{\\setSSIC}[1]{\\renewcommand{\\DocumentSSIC}{#1}}


%-----------------------------------------------------------------------------
% Serial Number
%-----------------------------------------------------------------------------

\\newcommand{\\DocumentSerial}{}
\\newcommand{\\setSerial}[1]{\\renewcommand{\\DocumentSerial}{#1}}


%-----------------------------------------------------------------------------
% In Reply Refer To (Optional)
%-----------------------------------------------------------------------------
% SECNAV M-5216.5 App C, Para 1.a: "IN REPLY REFER TO" in small caps
% Printed above the sender's symbols block (SSIC/Serial/Date)

\\newif\\ifInReplyEnabled
\\InReplyEnabledfalse

\\newcommand{\\enableInReplyReferTo}{\\InReplyEnabledtrue}


%-----------------------------------------------------------------------------
% Date
%-----------------------------------------------------------------------------

\\newcommand{\\DocumentDate}{}
\\newcommand{\\setDocumentDate}[1]{\\renewcommand{\\DocumentDate}{#1}}


%-----------------------------------------------------------------------------
% From Block
%-----------------------------------------------------------------------------
% Supports up to 4 lines for detailed sender information:
%   Line 1: Rank Name EDIPI/MOS Service
%   Line 2: Unit/Organization
%   Line 3: Address (City, State ZIP)
%   Line 4: Phone / Email

\\newcommand{\\FromLine}{}
\\newcommand{\\FromLineTwo}{}
\\newcommand{\\FromLineThree}{}
\\newcommand{\\FromLineFour}{}

\\newcommand{\\setFrom}[4]{%
    \\renewcommand{\\FromLine}{#1}%
    \\renewcommand{\\FromLineTwo}{#2}%
    \\renewcommand{\\FromLineThree}{#3}%
    \\renewcommand{\\FromLineFour}{#4}%
}


%-----------------------------------------------------------------------------
% To Block
%-----------------------------------------------------------------------------

\\newcommand{\\ToLine}{}
\\newcommand{\\ToLineTwo}{}
\\newcommand{\\ToLineThree}{}
\\newcommand{\\ToLineFour}{}

\\newcommand{\\setTo}[4]{%
    \\renewcommand{\\ToLine}{#1}%
    \\renewcommand{\\ToLineTwo}{#2}%
    \\renewcommand{\\ToLineThree}{#3}%
    \\renewcommand{\\ToLineFour}{#4}%
}


%-----------------------------------------------------------------------------
% Via Block (Optional)
%-----------------------------------------------------------------------------

\\newif\\ifViaEnabled
\\ViaEnabledfalse

\\newcommand{\\ViaLineOne}{}
\\newcommand{\\ViaLineTwo}{}
\\newcommand{\\ViaLineThree}{}
\\newcommand{\\ViaLineFour}{}

\\newcommand{\\setVia}[4]{%
    \\ViaEnabledtrue
    \\renewcommand{\\ViaLineOne}{#1}%
    \\renewcommand{\\ViaLineTwo}{#2}%
    \\renewcommand{\\ViaLineThree}{#3}%
    \\renewcommand{\\ViaLineFour}{#4}%
}


%-----------------------------------------------------------------------------
% Subject
%-----------------------------------------------------------------------------

\\newcommand{\\SubjectLine}{}
\\newcommand{\\setSubject}[1]{\\renewcommand{\\SubjectLine}{#1}}


%-----------------------------------------------------------------------------
% Business Letter Fields
%-----------------------------------------------------------------------------

\\newcommand{\\BusinessSalutation}{}
\\newcommand{\\setBusinessSalutation}[1]{\\renewcommand{\\BusinessSalutation}{#1}}

\\newcommand{\\BusinessClose}{}
\\newcommand{\\setBusinessClose}[1]{\\renewcommand{\\BusinessClose}{#1}}

% Business letter date format: Month spelled out (January 5, 2015)
\\newcommand{\\BusinessDate}{}
\\newcommand{\\setBusinessDate}[1]{\\renewcommand{\\BusinessDate}{#1}}

% Business letter attention line (optional)
\\newcommand{\\AttentionLine}{}
\\newcommand{\\setAttentionLine}[1]{\\renewcommand{\\AttentionLine}{#1}}

% Business letter enclosures (mentioned in body, listed after signature)
\\newcommand{\\BusinessEnclosures}{}
\\newcommand{\\setBusinessEnclosures}[1]{\\renewcommand{\\BusinessEnclosures}{#1}}


%-----------------------------------------------------------------------------
% POC Email
%-----------------------------------------------------------------------------

\\newcommand{\\POCEmail}{}
\\newcommand{\\setPOC}[1]{\\renewcommand{\\POCEmail}{#1}}


%=============================================================================
%                        LETTERHEAD CONFIGURATION
%=============================================================================

\\newcommand{\\UnitName}{}
\\newcommand{\\UnitLineTwo}{}
\\newcommand{\\UnitLineThree}{}
\\newcommand{\\UnitLineFour}{}

\\newcommand{\\setLetterhead}[4]{%
    \\renewcommand{\\UnitName}{#1}%
    \\renewcommand{\\UnitLineTwo}{#2}%
    \\renewcommand{\\UnitLineThree}{#3}%
    \\renewcommand{\\UnitLineFour}{#4}%
}


%=============================================================================
%                    CONDITIONAL/OPTIONAL FIELD HELPERS
%=============================================================================
% These macros allow format templates to conditionally print fields.
% Use these for OPTIONAL fields that may or may not be provided.
% REQUIRED fields per SECNAV compliance should be printed directly.
%
% Available helpers:
%   \\optionalLine{macro}        - Prints macro\\\\ if non-empty
%   \\optionalField{macro}       - Prints macro if non-empty (no newline)
%   \\optionalWithLabel{Label}{macro} - Prints "Label: macro\\\\" if non-empty
%   \\ifNotEmpty{macro}{content} - Executes content if macro is non-empty
%   \\ifNotEmptyElse{macro}{if-set}{if-empty} - Branch based on macro value
%
% Usage examples:
%   \\optionalLine{\\SignatoryRank}     % Prints "Major\\\\" or nothing
%   \\optionalField{\\SignatoryTitle}   % Prints title or nothing
%   \\ifNotEmpty{\\SignatureImage}{...} % Conditional block
%=============================================================================

% Print field followed by \\\\ if non-empty, nothing if empty
% Usage: \\optionalLine{\\SignatoryRank}
\\newcommand{\\optionalLine}[1]{%
    \\ifx#1\\empty\\else#1\\\\\\fi
}

% Print field without trailing newline if non-empty
% Usage: \\optionalField{\\SignatoryTitle}
\\newcommand{\\optionalField}[1]{%
    \\ifx#1\\empty\\else#1\\fi
}

% Print "Label: value\\\\" if value is non-empty
% Usage: \\optionalWithLabel{POC}{\\POCEmail}
\\newcommand{\\optionalWithLabel}[2]{%
    \\ifx#2\\empty\\else#1: #2\\\\\\fi
}

% Execute content if macro is non-empty
% Usage: \\ifNotEmpty{\\SignatoryRank}{Rank: \\SignatoryRank\\\\}
\\newcommand{\\ifNotEmpty}[2]{%
    \\ifx#1\\empty\\else#2\\fi
}

% Execute first content if non-empty, else execute second content
% Usage: \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev}{\\MakeUppercase{\\SignatoryName}}
\\newcommand{\\ifNotEmptyElse}[3]{%
    \\ifx#1\\empty#3\\else#2\\fi
}

% Legacy compatibility - string-based field name version
\\newcommand{\\ifHasValue}[2]{%
    \\expandafter\\ifx\\csname #1\\endcsname\\empty\\else#2\\fi
}

\\newcommand{\\ifHasValueElse}[3]{%
    \\expandafter\\ifx\\csname #1\\endcsname\\empty#3\\else#2\\fi
}


%=============================================================================
%                        SIGNATORY CONFIGURATION
%=============================================================================
% SECNAV M-5216.5 Ch 7, Para 14.a.(1):
%   "The last name appears in all capital letters with the exception
%    of a last name beginning with a prefix."
%
% The template auto-capitalizes the last name in signatures while
% preserving your From block exactly as typed.

\\newcommand{\\SignatoryFirstName}{}
\\newcommand{\\SignatoryMiddleInitial}{}
\\newcommand{\\SignatoryLastName}{}
\\newcommand{\\SignatoryRank}{}
\\newcommand{\\SignatoryTitle}{}

% SignatureImage: Set to \\empty by default so \\ifx\\SignatureImage\\empty works
\\let\\SignatureImage\\empty

% Legacy compatibility
\\newcommand{\\SignatoryName}{}
\\newcommand{\\SignatoryAbbrev}{}

\\newcommand{\\setSignatory}[5]{%
    \\renewcommand{\\SignatoryFirstName}{#1}%
    \\renewcommand{\\SignatoryMiddleInitial}{#2}%
    \\renewcommand{\\SignatoryLastName}{#3}%
    \\renewcommand{\\SignatoryRank}{#4}%
    \\renewcommand{\\SignatoryTitle}{#5}%
}

\\newcommand{\\setSignatoryName}[1]{\\renewcommand{\\SignatoryName}{#1}}
\\newcommand{\\setSignatoryAbbrev}[1]{\\renewcommand{\\SignatoryAbbrev}{#1}}

% By direction authority line (e.g., "By direction", "By direction of the Commander")
\\newcommand{\\ByDirection}{}
\\newcommand{\\setByDirection}[1]{\\renewcommand{\\ByDirection}{#1}}

% setSignatureImage: If non-empty, redefine SignatureImage so \\ifx check works
\\newcommand{\\setSignatureImage}[1]{%
    \\def\\temp{#1}%
    \\ifx\\temp\\empty\\else\\def\\SignatureImage{#1}\\fi
}


%=============================================================================
%               JOINT LETTER / JOINT MEMORANDUM COMMAND STUBS
%=============================================================================
% These are placeholder definitions so config/document.tex can call them
% before the format file is loaded. The actual format file will redefine.

\\newcommand{\\SeniorCommandName}{}
\\newcommand{\\SeniorCommandZip}{}
\\newcommand{\\SeniorCommandCode}{}
\\newcommand{\\SeniorFromLine}{}

\\newcommand{\\JuniorCommandName}{}
\\newcommand{\\JuniorCommandZip}{}
\\newcommand{\\JuniorCommandCode}{}
\\newcommand{\\JuniorSSIC}{}
\\newcommand{\\JuniorSerial}{}
\\newcommand{\\JuniorDate}{}
\\newcommand{\\JuniorSignatoryName}{}
\\newcommand{\\JuniorSignatoryRank}{}
\\newcommand{\\JuniorSignatoryTitle}{}
\\newcommand{\\JuniorByDirection}{}
\\newcommand{\\JuniorFromLine}{}

\\newcommand{\\CommonLocation}{}

% Stub setters - format files will redefine these if they have different signatures
\\newcommand{\\setSeniorCommand}[4]{%
    \\renewcommand{\\SeniorCommandName}{#1}%
    \\renewcommand{\\SeniorCommandZip}{#2}%
    \\renewcommand{\\SeniorCommandCode}{#3}%
    \\renewcommand{\\SeniorFromLine}{#4}%
}

\\newcommand{\\setJuniorCommand}[9]{%
    \\renewcommand{\\JuniorCommandName}{#1}%
    \\renewcommand{\\JuniorCommandZip}{#2}%
    \\renewcommand{\\JuniorCommandCode}{#3}%
    \\renewcommand{\\JuniorSSIC}{#4}%
    \\renewcommand{\\JuniorSerial}{#5}%
    \\renewcommand{\\JuniorDate}{#6}%
    \\renewcommand{\\JuniorSignatoryName}{#7}%
    \\renewcommand{\\JuniorSignatoryTitle}{#8}%
    \\renewcommand{\\JuniorFromLine}{#9}%
}

\\newcommand{\\setCommonLocation}[1]{\\renewcommand{\\CommonLocation}{#1}}


%=============================================================================
%                     CLASSIFICATION MARKING PLACEMENT
%=============================================================================

\\newcommand{\\placeClassificationMarkings}{%
    \\ifClassificationEnabled
        \\begin{textblock*}{6.5in}(1in, 0.25in)%
            \\centering\\ClassificationMarking
        \\end{textblock*}%
        \\begin{textblock*}{6.5in}(1in, 10.75in)%
            \\centering\\ClassificationMarking
        \\end{textblock*}%
    \\fi
}


%=============================================================================
%                           LETTERHEAD PRINTING
%=============================================================================

\\newcommand{\\printLetterhead}{%
    \\begin{textblock*}{1in}(0.5in, 0.5in)%
        \\IfFileExists{attachments/dod-seal.png}{%
            \\includegraphics[width=1in]{attachments/dod-seal.png}%
        }{%
            \\framebox[1in][c]{%
                \\parbox{0.9in}{\\centering\\scriptsize DoD Seal\\\\(add dod-seal.png)}%
            }%
        }%
    \\end{textblock*}%
    \\begin{textblock*}{4in}(2.25in, 0.625in)%
        \\centering
        \\fontsize{10pt}{11pt}\\selectfont
        \\textcolor{navyblue}{\\textbf{UNITED STATES MARINE CORPS}}\\\\
        \\fontsize{8pt}{9pt}\\selectfont
        \\textcolor{navyblue}{\\UnitName}\\\\
        \\textcolor{navyblue}{\\UnitLineTwo}\\\\
        \\fontsize{6pt}{7pt}\\selectfont
        \\textcolor{navyblue}{\\UnitLineThree}\\\\
        \\textcolor{navyblue}{\\UnitLineFour}
    \\end{textblock*}%
    \\vspace*{0.5in}%
}


%=============================================================================
%                            REFERENCES BLOCK
%=============================================================================

% Flags set by JavaScript in flags.tex (loaded in preamble)
\\newif\\ifhasrefs
\\hasrefsfalse
\\newcommand{\\setHasReferences}{\\global\\hasrefstrue}

\\newif\\ifhasencls
\\hasenclsfalse
\\newcommand{\\setHasEnclosures}{\\global\\hasenclstrue}

% Load flags file (sets hasrefs and hasencls if content exists)
\\input{flags}

\\makeatletter
\\newcommand{\\setRefURL}[2]{%
    \\expandafter\\gdef\\csname ref@url@#1\\endcsname{#2}%
}
\\makeatother

\\input{reference-urls}

\\makeatletter
\\newcommand{\\refitem}[2]{%
    \\@ifundefined{ref@url@#1}{%
        (#1) #2\\\\%
    }{%
        (\\href{\\csname ref@url@#1\\endcsname}{\\textcolor{blue}{#1}}) #2\\\\%
    }%
}
\\makeatother

% SECNAV M-5216.5 Ch 7, Para 10.c: 4 spaces after "Ref:"
% Only print if hasrefs flag is set (by flags.tex)
\\newcommand{\\printReferences}{%
    \\ifhasrefs
        \\vspace{12pt}
        \\noindent
        \\begin{tabular}{@{}l@{}p{5.9in}@{}}
            Ref:\\hspace{4\\fontdimen2\\font} & \\begin{minipage}[t]{5.9in}
                       \\input{references}
                   \\end{minipage}
        \\end{tabular}%
    \\fi
}


%=============================================================================
%                            ENCLOSURES SYSTEM
%=============================================================================
%
% Per SECNAV M-5216.5 Ch 2, Para 13:
%   - Marking: "Enclosure (1)" in LOWER RIGHT CORNER
%   - First page: No page number
%   - Second+ pages: Number centered, 2 lines below "Enclosure (#)" marking
%   - Each enclosure numbered INDEPENDENTLY (1, 2, 3... not continuous)
%
%=============================================================================

\\newcounter{enclmax}
\\setcounter{enclmax}{0}

% Counter for tracking pages within each enclosure
\\newcounter{enclpagenum}

\\makeatletter
\\newcommand{\\enclosure}[3]{%
    % Args: {number}{filename.pdf}{Title}
    \\ifnum#1>\\value{enclmax}%
        \\setcounter{enclmax}{#1}%
    \\fi
    \\expandafter\\gdef\\csname encl@file@#1\\endcsname{#2}%
    \\expandafter\\gdef\\csname encl@title@#1\\endcsname{#3}%
    \\expandafter\\gdef\\csname encl@defined@#1\\endcsname{1}%
}
\\makeatother

% SECNAV M-5216.5 Ch 7, Para 11.b: 3 spaces after "Encl:"
% Numbers in parentheses: (1), (2), (3)... EVEN IF ONLY ONE
\\makeatletter
\\newcommand{\\printEnclosureList}{%
    \\ifnum\\value{enclmax}>0
        \\vspace{12pt}
        \\noindent
        \\begin{tabular}{@{}l@{}p{5.85in}@{}}
            Encl:\\hspace{3\\fontdimen2\\font} & \\begin{minipage}[t]{5.85in}
                       \\newcounter{encllistcount}%
                       \\setcounter{encllistcount}{0}%
                       \\loop\\ifnum\\value{encllistcount}<\\value{enclmax}%
                           \\stepcounter{encllistcount}%
                           \\@ifundefined{encl@defined@\\arabic{encllistcount}}{}{%
                               (\\hyperlink{enclosure\\arabic{encllistcount}}{\\textcolor{blue}{\\arabic{encllistcount}}}) \\csname encl@title@\\arabic{encllistcount}\\endcsname\\\\%
                           }%
                       \\repeat
                   \\end{minipage}
        \\end{tabular}%
    \\fi
}
\\makeatother

\\newcommand{\\currentenclnum}{0}
\\newcommand{\\currentencltitle}{}
\\newcommand{\\currentenclpagenum}{1}

% Page style for enclosure first page (no page number)
% SECNAV M-5216.5 Ch 2, Para 13.b: First page - do NOT number
\\fancypagestyle{enclosurefirstpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    % Lower right corner: "Enclosure (X)" - SECNAV Ch 2, Para 13.a
    \\fancyfoot[R]{Enclosure (\\currentenclnum)}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}

% Page style for enclosure continuation pages (page number centered below marking)
% SECNAV M-5216.5 Ch 2, Para 13.a-b: Page number centered, 2 lines below marking
\\fancypagestyle{enclosurepage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    % Lower right corner: "Enclosure (X)" on first line of footer
    % Page number centered, 2 lines (~24pt) below the enclosure marking
    \\fancyfoot[R]{\\raisebox{8pt}{Enclosure (\\currentenclnum)}}%
    \\fancyfoot[C]{\\currentenclpagenum}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}

% Helper to check for JSPDF marker (PDF will be appended by JavaScript)
\\newcommand{\\jspdfmarker}{JSPDF}

\\makeatletter
\\newcommand{\\includeEnclosures}{%
    \\ifnum\\value{enclmax}>0
        \\newcounter{inclcount}%
        \\setcounter{inclcount}{0}%
        \\loop\\ifnum\\value{inclcount}<\\value{enclmax}%
            \\stepcounter{inclcount}%
            \\@ifundefined{encl@defined@\\arabic{inclcount}}{}{%
                \\edef\\currentfile{\\csname encl@file@\\arabic{inclcount}\\endcsname}%
                \\xdef\\currentencltitle{\\csname encl@title@\\arabic{inclcount}\\endcsname}%
                \\xdef\\currentenclnum{\\arabic{inclcount}}%
                % Reset page counter for this enclosure
                \\setcounter{enclpagenum}{1}%
                \\ifx\\currentfile\\empty
                    % No PDF - create placeholder page for text-only enclosure
                    \\newpage
                    \\hypertarget{enclosure\\currentenclnum}{}%
                    \\thispagestyle{enclosurefirstpage}%
                    \\vspace*{2in}%
                    \\begin{center}
                        \\fontsize{16pt}{20pt}\\selectfont
                        \\textbf{\\currentencltitle}\\\\[1in]
                        \\fontsize{12pt}{16pt}\\selectfont
                        \\textit{(Physical document attached separately)}
                    \\end{center}
                \\else
                    \\ifx\\currentfile\\jspdfmarker
                        % JSPDF marker: JavaScript will append this PDF
                        % Do NOT create placeholder - JS handles it
                    \\else
                        % Include PDF with proper SECNAV enclosure marking
                        % (Note: SwiftLaTeX doesn't support \\includepdf)
                        \\includepdf[
                            pages=-,
                            scale=0.85,
                            frame,
                            pagecommand={%
                                % Capture current page number for footer before incrementing
                                \\xdef\\currentenclpagenum{\\arabic{enclpagenum}}%
                                % Set hyperlink target on first page
                                \\ifnum\\value{enclpagenum}=1
                                    \\hypertarget{enclosure\\currentenclnum}{}%
                                    \\thispagestyle{enclosurefirstpage}%
                                \\else
                                    \\thispagestyle{enclosurepage}%
                                \\fi
                                % Increment page counter for next page
                                \\stepcounter{enclpagenum}%
                            }
                        ]{enclosures/\\currentfile}
                    \\fi
                \\fi
            }%
        \\repeat
    \\fi
}
\\makeatother


%=============================================================================
%                       ENCLOSURE REFERENCE COMMANDS
%=============================================================================

\\newcommand{\\enclref}[1]{%
    \\hyperlink{enclosure#1}{Enclosure~(#1)}%
}

\\newcommand{\\encl}[1]{%
    \\hyperlink{enclosure#1}{\\textcolor{blue}{#1}}%
}


%=============================================================================
%                        BODY PARAGRAPH COMMANDS
%=============================================================================

\\newcounter{mainpara}
\\setcounter{mainpara}{0}

\\newcommand{\\parasection}[1]{%
    \\stepcounter{mainpara}%
    \\vspace{12pt}%
    \\noindent\\arabic{mainpara}. \\underline{#1}:%
}

\\newlist{subpara}{enumerate}{1}
\\setlist[subpara,1]{
    label     = \\alph*.,
    leftmargin = 0.4in,
    labelsep   = 0.1in,
    itemsep    = 12pt,
    topsep     = 12pt
}

\\newlist{subsubpara}{enumerate}{1}
\\setlist[subsubpara,1]{
    label     = (\\arabic*),
    leftmargin = 0.8in,
    labelsep   = 0.1in,
    itemsep    = 12pt,
    topsep     = 12pt
}


%=============================================================================
%                        LOAD CONFIGURATION FILES
%=============================================================================

% Load enclosure definitions first (so counter is set before document)
\\input{enclosures}


%=============================================================================
%=============================================================================
%
%                         DOCUMENT CONTENT BEGINS HERE
%
%=============================================================================
%=============================================================================


\\begin{document}


%=============================================================================
% LOAD CONFIGURATION FROM EXTERNAL FILES
%=============================================================================

\\input{letterhead}
\\input{classification}
\\input{document}
\\input{signatory}

% Apply font settings after config is loaded
\\applyFontSettings

%=============================================================================
% LOAD FORMAT-SPECIFIC MODULE
%=============================================================================
% Based on \\DocumentType setting in config/document.tex, loads:
%   - formats/mfr.tex
%   - formats/naval_letter.tex
%   - formats/business_letter.tex
%=============================================================================

\\input{\\DocumentType}


%=============================================================================
% APPLY PAGE STYLE (defined by format module)
%=============================================================================

\\pagestyle{documentpage}
% Use firstpage style if defined (naval_letter), otherwise use documentpage
\\makeatletter
\\@ifundefined{ps@firstpage}{\\thispagestyle{documentpage}}{\\thispagestyle{firstpage}}
\\makeatother


%=============================================================================
% PAGE 1 - LETTERHEAD AND HEADER BLOCKS
%=============================================================================

\\printLetterhead
\\printDateAndTitle
\\printAddressBlock
\\printReferences
\\printEnclosureList


%=============================================================================
% BODY CONTENT - Edit in config/body.tex
%=============================================================================

\\input{body}


%=============================================================================
% SIGNATURE BLOCK
%=============================================================================

\\printSignature


%=============================================================================
% ENCLOSURES - Auto-included from enclosures/ folder
%=============================================================================

\\includeEnclosures


%=============================================================================
\\end{document}
`,

  // Template files
  'tex/templates/action_memorandum.tex': `
%=============================================================================
%
%                   ACTION MEMORANDUM FORMAT MODULE
%                        (Executive - HqDON/OSD)
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 12, Para 12-4.3
%
% What It's For:
%   Forward material requiring approval/signature; recommend solutions.
%
% Key Characteristics:
%   - Length: One page (unless complex)
%   - Style: Short, concise bullet statements (black dot preferred)
%   - Font: Times New Roman, 12-point
%   - Margins: 2" top first page (may reduce to 1.75"), 1" sides/bottom
%   - Spacing: Double space between headings and bullets
%   - Page numbers: Bottom center, starting page 2
%   - Assembly: Do NOT staple or use clam clips
%
%=============================================================================


%=============================================================================
%                         FONT OVERRIDE
%=============================================================================
% Executive memos use Times New Roman, not Courier

\\renewcommand{\\familydefault}{\\rmdefault}
\\usepackage{times}


%=============================================================================
%                    MEMORANDUM FOR ADDRESSEE
%=============================================================================

\\newcommand{\\MemorandumForAddressee}{}
\\newcommand{\\setMemorandumForAddressee}[1]{\\renewcommand{\\MemorandumForAddressee}{#1}}


%=============================================================================
%                    ACTION MEMO FIELDS
%=============================================================================

\\newcommand{\\ActionFrom}{}
\\newcommand{\\setActionFrom}[1]{\\renewcommand{\\ActionFrom}{#1}}

\\newcommand{\\ActionSubject}{}
\\newcommand{\\setActionSubject}[1]{\\renewcommand{\\ActionSubject}{#1}}


%=============================================================================
%                    DATE AND MEMO TITLE
%=============================================================================

\\newcommand{\\printDateAndTitle}{%
    % SECNAV Ch 12: 2" top margin on first page (1" from geometry + 1" here)
    \\vspace*{1in}%
    \\begin{center}
        \\textbf{ACTION MEMO}
    \\end{center}
    \\vspace{12pt}%
    \\hfill \\DocumentDate\\\\[24pt]
    \\noindent MEMORANDUM FOR \\MemorandumForAddressee\\\\[12pt]
}


%=============================================================================
%                       FROM / SUBJECT BLOCK
%=============================================================================

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        FROM: & \\ActionFrom\\tabularnewline
        & \\tabularnewline[-6pt]
        SUBJECT: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
}


%=============================================================================
%                SIGNATURE BLOCK (Action Memo Style)
%=============================================================================

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name (use abbreviated if available, else full name uppercased)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: Rank
        \\optionalLine{\\SignatoryRank}%
        % Optional: Title
        \\optionalLine{\\SignatoryTitle}%
        % Optional: By direction authority line (e.g., "By direction of the Commander")
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                         LETTERHEAD OVERRIDE
%=============================================================================

\\renewcommand{\\printLetterhead}{}


%=============================================================================
%                              PAGE STYLE
%=============================================================================
% First page: NOT numbered
% Page 2+: Bottom center

\\fancypagestyle{firstpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\thepage}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/business_letter.tex': `
%=============================================================================
%
%                     BUSINESS LETTER FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 11
%   - MCO 5216.20B w/Admin CH-4 (Marine Corps Supplement)
%
% Key differences from Standard Naval Letter:
%   - ID symbols in upper LEFT corner (not right)
%   - Date format: Month spelled out (January 5, 2015)
%   - Has salutation (Dear Mr./Ms.) and complimentary close (Sincerely,)
%   - Paragraphs NOT numbered, indented 4 spaces (0.5")
%   - References/Enclosures mentioned in body only, not formal lines
%   - Inside address 2-8 lines below date
%
%=============================================================================


%=============================================================================
%                         ID SYMBOLS BLOCK (Upper LEFT)
%=============================================================================
% SECNAV Ch 11: ID symbols in upper LEFT corner, blocked one below the other
% Date format: Month spelled out, day in numerals, comma, full year

\\newcommand{\\printDateAndTitle}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{}}
        \\DocumentSSIC\\\\
        \\optionalField{\\DocumentSerial}%
        \\BusinessDate% Use civilian date format (January 5, 2015)
    \\end{tabular}
}


%=============================================================================
%                    INSIDE ADDRESS AND SALUTATION
%=============================================================================
% SECNAV Ch 11, Para 11-4: Inside address 2-8 lines below date
% SECNAV Ch 11, Para 11-6: Salutation with colon (Dear Mr. Jones:)

\\newcommand{\\printAddressBlock}{%
    \\par\\vspace{24pt}% 2 lines below date (adjustable 2-8 lines)
    \\noindent
    \\optionalLine{\\ToLine}%
    \\optionalLine{\\ToLineTwo}%
    \\optionalLine{\\ToLineThree}%
    \\optionalField{\\ToLineFour}%
    %
    % Attention line (optional) - SECNAV Ch 11, Para 11-5
    \\ifNotEmpty{\\AttentionLine}{%
        \\par\\vspace{12pt}%
        \\noindent Attention: \\AttentionLine
    }%
    %
    % Salutation with colon - SECNAV Ch 11, Para 11-6
    \\par\\vspace{12pt}%
    \\noindent \\BusinessSalutation
    %
    % Subject line (optional) - SECNAV Ch 11, Para 11-7
    \\ifNotEmpty{\\SubjectLine}{%
        \\par\\vspace{12pt}%
        \\noindent SUBJECT: \\MakeUppercase{\\SubjectLine}%
    }%
    %
    % CUI block (if enabled)
    \\ifCUIEnabled
        \\par\\vspace{12pt}%
        \\noindent \\textbf{CUI//\\CUICategory}%
        \\par\\noindent \\CUIDistStatement
    \\fi
}


%=============================================================================
%                         BODY TEXT FORMATTING
%=============================================================================
% SECNAV Ch 11, Para 11-8:
%   - Single-space within paragraphs
%   - Double-space between paragraphs
%   - Main paragraphs indented 4 spaces (0.5")
%   - Subparagraphs indented additional 8 spaces
%   - DO NOT number main paragraphs

\\newcommand{\\businessLetterParIndent}{0.5in}

% Apply paragraph indentation for business letter body
\\newcommand{\\setupBusinessLetterBody}{%
    \\setlength{\\parindent}{\\businessLetterParIndent}%
    \\setlength{\\parskip}{12pt}% Double-space between paragraphs
}


%=============================================================================
%                  SIGNATURE BLOCK (Business Letter Style)
%=============================================================================
% SECNAV Ch 11, Para 11-10-12:
%   - Complimentary close "Sincerely," CENTERED, 2 lines below text
%   - Signature block CENTERED, 4 lines below "Sincerely,"
%   - Name in ALL CAPS
%   - Optional: Rank, Title, "By direction of the Commander"

\\newcommand{\\printSignature}{%
    % Complimentary close - CENTERED, 2 lines below text
    \\par\\vspace{24pt}%
    \\begin{center}
        \\BusinessClose
    \\end{center}
    %
    % Signature block - CENTERED, 4 lines below complimentary close
    \\vspace{36pt}%
    \\begin{center}
        \\begin{minipage}{3in}
            \\centering
            % Optional: Signature image
            \\ifNotEmpty{\\SignatureImage}{%
                \\IfFileExists{attachments/\\SignatureImage}{%
                    \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
                }{}%
            }%
            % Required: Name in ALL CAPS
            \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
            % Optional: Rank
            \\optionalLine{\\SignatoryRank}%
            % Optional: Title
            \\optionalLine{\\SignatoryTitle}%
            % Optional: By direction authority line
            \\optionalField{\\ByDirection}%
        \\end{minipage}
    \\end{center}
}


%=============================================================================
%                         ENCLOSURE LINE
%=============================================================================
% SECNAV Ch 11, Para 11-13:
%   - Position: 2nd line below signature block, flush left
%   - Format with descriptions: "Enclosures: 1. GPO Style Manual"
%   - Format without descriptions: "Enclosures (2)"

\\newcommand{\\printBusinessEnclosures}{%
    \\ifNotEmpty{\\BusinessEnclosures}{%
        \\par\\vspace{24pt}%
        \\noindent Enclosures: \\BusinessEnclosures
    }%
}


%=============================================================================
%                         COPY TO LINE
%=============================================================================
% SECNAV Ch 11, Para 11-15:
%   - Position: Left margin, 2nd line below enclosure (or signature if no encl)

\\newcommand{\\printBusinessCopyTo}{%
    \\ifNotEmpty{\\CopyToList}{%
        \\par\\vspace{24pt}%
        \\noindent Copy to: \\CopyToList
    }%
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================
% SECNAV Ch 11, Para 11-16:
%   - First page: NOT numbered
%   - Second+ pages: Centered, 1/2 inch from bottom, starting with "2"

\\fancypagestyle{firstpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{}% No page number on first page
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\thepage}% Page number centered
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/decision_memorandum.tex': `
%=============================================================================
%
%                     DECISION MEMORANDUM FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 10, Para 5
%
% What It's For:
%   Request an approval/disapproval decision from a SINGLE addressee.
%
% Format:
%   Use any memo format (plain-paper or letterhead), then add decision block:
%   - Position: Left margin
%   - Spacing: Two lines below the signature line
%
% Decision Block Format:
%   [ADDRESSEE'S TITLE] DECISION:
%   _____________________ Approved
%   _____________________ Disapproved
%   _____________________ Other
%
%=============================================================================


%=============================================================================
%                     DECISION ADDRESSEE CONFIGURATION
%=============================================================================
% The addressee's title for the decision block (e.g., "COMMANDING OFFICER")

\\newcommand{\\DecisionAddresseeTitle}{}
\\newcommand{\\setDecisionAddressee}[1]{\\renewcommand{\\DecisionAddresseeTitle}{#1}}


%=============================================================================
%                          DATE AND MEMO TITLE
%=============================================================================
% Uses plain-paper style (no letterhead) by default
% Date on line 6, right margin

\\newcommand{\\printDateAndTitle}{%
    \\hfill \\DocumentDate\\\\[12pt]
    \\noindent MEMORANDUM\\\\[12pt]
}


%=============================================================================
%              FROM / TO / VIA / SUBJ BLOCK (Plain-Paper Style)
%=============================================================================

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline
        To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline
        \\ifViaEnabled
            Via: & \\ViaLineOne\\ifdefempty{\\ViaLineTwo}{}{\\tabularnewline & \\ViaLineTwo}\\ifdefempty{\\ViaLineThree}{}{\\tabularnewline & \\ViaLineThree}\\ifdefempty{\\ViaLineFour}{}{\\tabularnewline & \\ViaLineFour}\\tabularnewline
        \\fi
        & \\tabularnewline[-6pt]
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%         SIGNATURE BLOCK WITH DECISION BLOCK (Decision Memo Style)
%=============================================================================
% Signature is name only
% Decision block: 2 lines below signature, at LEFT margin

\\newcommand{\\printSignature}{%
    \\vspace{36pt}%
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name only (abbreviated format preferred)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}%
    %
    % Decision Block - 2 lines below signature, at LEFT margin
    \\vspace{36pt}%

    \\noindent\\MakeUppercase{\\DecisionAddresseeTitle} DECISION:\\\\[12pt]
    \\noindent\\underline{\\hspace{2in}} Approved\\\\[12pt]
    \\noindent\\underline{\\hspace{2in}} Disapproved\\\\[12pt]
    \\noindent\\underline{\\hspace{2in}} Other%
}


%=============================================================================
%                         LETTERHEAD OVERRIDE
%=============================================================================
% Decision memo typically uses plain paper (no letterhead)

\\renewcommand{\\printLetterhead}{}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/information_memorandum.tex': `
%=============================================================================
%
%                   INFORMATION MEMORANDUM FORMAT MODULE
%                        (Executive - HqDON/OSD)
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 12, Para 12-4.4
%
% What It's For:
%   Convey information on developments not requiring action.
%
% Key Characteristics:
%   - Header: "INFO MEMO" centered, bold, all caps
%   - Address: "FOR:" double space below date
%   - Sender: "FROM:" double space below FOR (sender signs HERE)
%   - Subject: "SUBJECT:" double space below FROM
%   - Body: Succinct bullet statements, double-spaced
%   - Coordination: "COORDINATION:" double space below recommendation
%   - Signature block: NONE (sender signs on FROM line)
%   - Prepared by: "Prepared by:" left margin, double space below final text
%
%=============================================================================


%=============================================================================
%                         FONT OVERRIDE
%=============================================================================
% Executive memos use Times New Roman, not Courier

\\renewcommand{\\familydefault}{\\rmdefault}
\\usepackage{times}


%=============================================================================
%                    INFO MEMO FIELDS
%=============================================================================

\\newcommand{\\InfoMemoFor}{}
\\newcommand{\\setInfoMemoFor}[1]{\\renewcommand{\\InfoMemoFor}{#1}}

\\newcommand{\\InfoMemoFrom}{}
\\newcommand{\\setInfoMemoFrom}[1]{\\renewcommand{\\InfoMemoFrom}{#1}}

\\newcommand{\\InfoMemoCoordination}{}
\\newcommand{\\setInfoMemoCoordination}[1]{\\renewcommand{\\InfoMemoCoordination}{#1}}

\\newcommand{\\InfoMemoPreparedBy}{}
\\newcommand{\\setInfoMemoPreparedBy}[1]{\\renewcommand{\\InfoMemoPreparedBy}{#1}}


%=============================================================================
%                    HEADER AND DATE
%=============================================================================
% "INFO MEMO" centered, bold, all caps

\\newcommand{\\printDateAndTitle}{%
    \\begin{center}
        \\textbf{INFO MEMO}
    \\end{center}
    \\vspace{12pt}%
    \\hfill \\DocumentDate\\\\[24pt]
}


%=============================================================================
%                    FOR / FROM / SUBJECT BLOCK
%=============================================================================
% Sender signs on the FROM line (no separate signature block)

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        FOR: & \\InfoMemoFor\\tabularnewline
        & \\tabularnewline[-6pt]
        FROM: & \\InfoMemoFrom\\tabularnewline
        & \\tabularnewline[-6pt]
        SUBJECT: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
}


%=============================================================================
%             SIGNATURE BLOCK (Info Memo - Coordination/Prepared By)
%=============================================================================
% NO traditional signature block
% Instead: COORDINATION and Prepared by lines

\\newcommand{\\printSignature}{%
    % Coordination line (if provided)
    \\ifdefempty{\\InfoMemoCoordination}{}{%
        \\vspace{24pt}%
        \\noindent COORDINATION:\\\\[6pt]
        \\InfoMemoCoordination
    }%
    %
    % Prepared by line
    \\ifdefempty{\\InfoMemoPreparedBy}{}{%
        \\vspace{24pt}%
        \\noindent Prepared by: \\InfoMemoPreparedBy
    }%
}


%=============================================================================
%                         LETTERHEAD OVERRIDE
%=============================================================================

\\renewcommand{\\printLetterhead}{}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{firstpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\thepage}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/joint_letter.tex': `
%=============================================================================
%
%                       JOINT LETTER FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 7
%   - Ch 7, Para 7-1.2; Figure 7-4
%
% What It's For:
%   - Establish an agreement between two or more activities
%   - Address matters of mutual concern requiring coordination
%   - Issue joint policy or guidance from multiple commands
%   - Formalize coordination between commands of equal or different echelons
%
% Key Rules:
%   - Letterhead: Plain bond with typed command titles (senior on top)
%   - Dual ID blocks: Junior LEFT, Senior RIGHT
%   - "JOINT LETTER" typed above From: line
%   - From line: Senior commander listed FIRST
%   - Signatures: Junior LEFT (signs first), Senior RIGHT (signs last)
%
% Variation: For Joint Memorandum, replace "JOINT LETTER" with
%            "JOINT MEMORANDUM" above the From: line.
%
%=============================================================================


%=============================================================================
%                    COMMAND CONFIGURATION
%=============================================================================
% Commands are pre-defined in main.tex, format file just uses them.
% Junior command: left side, signs FIRST
% Senior command: right side, signs LAST


%=============================================================================
%                    JOINT LETTER LETTERHEAD
%=============================================================================
% Plain bond with typed command titles
% Senior command on TOP, Junior below
% ZIP codes in parentheses

\\renewcommand{\\printLetterhead}{%
    \\begin{center}
        {\\fontsize{10pt}{11pt}\\selectfont\\textbf{DEPARTMENT OF THE NAVY}}\\\\[6pt]
        {\\fontsize{8pt}{9pt}\\selectfont
            \\MakeUppercase{\\SeniorCommandName} (\\SeniorCommandZip)\\\\
            \\MakeUppercase{\\JuniorCommandName} (\\JuniorCommandZip)\\\\
            \\ifdefempty{\\CommonLocation}{}{\\MakeUppercase{\\CommonLocation}}
        }
    \\end{center}
    \\vspace*{0.25in}%
}


%=============================================================================
%                    DUAL ID BLOCKS AND DESIGNATION
%=============================================================================
% Junior command LEFT (signs first), Senior command RIGHT (signs last)
% "JOINT LETTER" typed at left margin above From: line

\\newcommand{\\printDateAndTitle}{%
    % Dual ID symbols - side by side
    \\noindent
    \\begin{tabular}[t]{@{}p{3in}@{\\hfill}p{3in}@{}}
        % Junior command (LEFT) - signs FIRST
        \\begin{tabular}[t]{@{}l@{}}
            \\optionalLine{\\JuniorCommandCode}%
            \\optionalLine{\\JuniorSSIC}%
            \\optionalLine{\\JuniorSerial}%
            \\optionalField{\\JuniorDate}%
        \\end{tabular}
        &
        % Senior command (RIGHT) - signs LAST
        \\begin{tabular}[t]{@{}l@{}}
            \\optionalLine{\\SeniorCommandCode}%
            \\optionalLine{\\DocumentSSIC}%
            \\optionalLine{\\DocumentSerial}%
            \\optionalField{\\DocumentDate}%
        \\end{tabular}
    \\end{tabular}
    \\par\\vspace{24pt}%
    %
    % JOINT LETTER designation
    \\noindent JOINT LETTER\\\\[12pt]
}


%=============================================================================
%                    FROM / TO / SUBJ BLOCK
%=============================================================================
% From: Senior commander listed FIRST, then junior
% Standard To: and Subj: lines

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\SeniorFromLine\\tabularnewline
              & \\JuniorFromLine\\tabularnewline
        To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline
        \\ifViaEnabled
            Via: & \\ViaLineOne\\ifdefempty{\\ViaLineTwo}{}{\\tabularnewline & \\ViaLineTwo}\\ifdefempty{\\ViaLineThree}{}{\\tabularnewline & \\ViaLineThree}\\ifdefempty{\\ViaLineFour}{}{\\tabularnewline & \\ViaLineFour}\\tabularnewline
        \\fi
        & \\tabularnewline[-6pt]
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                    DUAL SIGNATURE BLOCK
%=============================================================================
% Junior signs on LEFT (signs FIRST)
% Senior signs on RIGHT (signs LAST)
% NO overscoring (unlike MOA/MOU)

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%
    \\noindent
    \\begin{tabular}[t]{@{}p{3in}@{\\hfill}p{3in}@{}}
        % Junior command signature (LEFT) - signs FIRST
        \\begin{minipage}[t]{2.5in}
            \\raggedright
            \\MakeUppercase{\\JuniorSignatoryName}\\\\
            \\optionalLine{\\JuniorSignatoryTitle}%
            \\optionalField{\\JuniorByDirection}%
        \\end{minipage}
        &
        % Senior command signature (RIGHT) - signs LAST
        \\begin{minipage}[t]{2.5in}
            \\raggedright
            \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
            \\optionalLine{\\SignatoryTitle}%
            \\optionalField{\\ByDirection}%
        \\end{minipage}
    \\end{tabular}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/joint_memorandum.tex': `
%=============================================================================
%
%                     JOINT MEMORANDUM FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 7
%   - Ch 7, Para 7-1.2; Figure 7-4
%
% What It Is:
%   Same as Joint Letter, but uses "JOINT MEMORANDUM" designation
%   instead of "JOINT LETTER" above the From: line.
%
% Key Rules:
%   - Letterhead: Plain bond with typed command titles (senior on top)
%   - Dual ID blocks: Junior LEFT, Senior RIGHT
%   - "JOINT MEMORANDUM" typed above From: line
%   - From line: Senior commander listed FIRST
%   - Signatures: Junior LEFT (signs first), Senior RIGHT (signs last)
%
%=============================================================================


%=============================================================================
%                    COMMAND CONFIGURATION
%=============================================================================
% Commands are pre-defined in main.tex, format file just uses them.
% Junior command: left side, signs FIRST
% Senior command: right side, signs LAST


%=============================================================================
%                    JOINT MEMORANDUM LETTERHEAD
%=============================================================================
% Plain bond with typed command titles
% Senior command on TOP, Junior below
% ZIP codes in parentheses

\\renewcommand{\\printLetterhead}{%
    \\begin{center}
        {\\fontsize{10pt}{11pt}\\selectfont\\textbf{DEPARTMENT OF THE NAVY}}\\\\[6pt]
        {\\fontsize{8pt}{9pt}\\selectfont
            \\MakeUppercase{\\SeniorCommandName} (\\SeniorCommandZip)\\\\
            \\MakeUppercase{\\JuniorCommandName} (\\JuniorCommandZip)\\\\
            \\ifdefempty{\\CommonLocation}{}{\\MakeUppercase{\\CommonLocation}}
        }
    \\end{center}
    \\vspace*{0.25in}%
}


%=============================================================================
%                    DUAL ID BLOCKS AND DESIGNATION
%=============================================================================
% Junior command LEFT (signs first), Senior command RIGHT (signs last)
% "JOINT MEMORANDUM" typed at left margin above From: line

\\newcommand{\\printDateAndTitle}{%
    % Dual ID symbols - side by side
    \\noindent
    \\begin{tabular}[t]{@{}p{3in}@{\\hfill}p{3in}@{}}
        % Junior command (LEFT) - signs FIRST
        \\begin{tabular}[t]{@{}l@{}}
            \\optionalLine{\\JuniorCommandCode}%
            \\optionalLine{\\JuniorSSIC}%
            \\optionalLine{\\JuniorSerial}%
            \\optionalField{\\JuniorDate}%
        \\end{tabular}
        &
        % Senior command (RIGHT) - signs LAST
        \\begin{tabular}[t]{@{}l@{}}
            \\optionalLine{\\SeniorCommandCode}%
            \\optionalLine{\\DocumentSSIC}%
            \\optionalLine{\\DocumentSerial}%
            \\optionalField{\\DocumentDate}%
        \\end{tabular}
    \\end{tabular}
    \\par\\vspace{24pt}%
    %
    % JOINT MEMORANDUM designation
    \\noindent JOINT MEMORANDUM\\\\[12pt]
}


%=============================================================================
%                    FROM / TO / SUBJ BLOCK
%=============================================================================
% From: Senior commander listed FIRST, then junior
% Standard To: and Subj: lines

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\SeniorFromLine\\tabularnewline
              & \\JuniorFromLine\\tabularnewline
        To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline
        \\ifViaEnabled
            Via: & \\ViaLineOne\\ifdefempty{\\ViaLineTwo}{}{\\tabularnewline & \\ViaLineTwo}\\ifdefempty{\\ViaLineThree}{}{\\tabularnewline & \\ViaLineThree}\\ifdefempty{\\ViaLineFour}{}{\\tabularnewline & \\ViaLineFour}\\tabularnewline
        \\fi
        & \\tabularnewline[-6pt]
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                    DUAL SIGNATURE BLOCK
%=============================================================================
% Junior signs on LEFT (signs FIRST)
% Senior signs on RIGHT (signs LAST)
% NO overscoring (unlike MOA/MOU)

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%
    \\noindent
    \\begin{tabular}[t]{@{}p{3in}@{\\hfill}p{3in}@{}}
        % Junior command signature (LEFT) - signs FIRST
        \\begin{minipage}[t]{2.5in}
            \\raggedright
            \\MakeUppercase{\\JuniorSignatoryName}\\\\
            \\optionalLine{\\JuniorSignatoryTitle}%
            \\optionalField{\\JuniorByDirection}%
        \\end{minipage}
        &
        % Senior command signature (RIGHT) - signs LAST
        \\begin{minipage}[t]{2.5in}
            \\raggedright
            \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
            \\optionalLine{\\SignatoryTitle}%
            \\optionalField{\\ByDirection}%
        \\end{minipage}
    \\end{tabular}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/letterhead_memorandum.tex': `
%=============================================================================
%
%                     LETTERHEAD MEMORANDUM FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 10, Para 4
%   - Figure 10-4
%
% What It's For:
%   More formal than printed form or plain-paper memo. Can be used:
%   - Internally: Within your command for formal matters
%   - Externally (LIMITED): Only when ALL three conditions are met:
%     1. Direct liaison is authorized
%     2. Matter is routine
%     3. Memo does NOT make a commitment or take an official stand
%
% Requirements:
%   - Paper: Command letterhead
%   - SSIC: Required
%   - Originator code: Required (e.g., "Memo S-3/024")
%   - Date: Required
%   - Signature: Name only  full signature line NOT required
%                (From: line identifies signer)
%
%=============================================================================


%=============================================================================
%                    DATE/SSIC BLOCK AND MEMO TITLE
%=============================================================================
% Uses standard letter format but types "MEMORANDUM" instead of
% starting with text.
% SSIC, originator code (Memo XX/###), and date in upper right

\\newcommand{\\printDateAndTitle}{%
    \\vspace*{0.5in}%
    \\hfill
    \\begin{tabular}[t]{@{}l@{}}
        \\ifInReplyEnabled
            {\\fontsize{5pt}{6pt}\\selectfont IN REPLY REFER TO}\\\\
        \\fi
        \\DocumentSSIC\\\\
        \\DocumentSerial\\\\
        \\DocumentDate
    \\end{tabular}\\\\[24pt]
    \\noindent MEMORANDUM\\\\[12pt]
}


%=============================================================================
%              FROM / TO / VIA / SUBJ BLOCK (Letterhead Memo Style)
%=============================================================================

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline
        To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline
        \\ifViaEnabled
            Via: & \\ViaLineOne\\ifdefempty{\\ViaLineTwo}{}{\\tabularnewline & \\ViaLineTwo}\\ifdefempty{\\ViaLineThree}{}{\\tabularnewline & \\ViaLineThree}\\ifdefempty{\\ViaLineFour}{}{\\tabularnewline & \\ViaLineFour}\\tabularnewline
        \\fi
        & \\tabularnewline[-6pt]
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                SIGNATURE BLOCK (Letterhead Memo Style)
%=============================================================================
% Signature is name only  NO rank, NO organizational title
% From: line already identifies who's signing
% Per SECNAV Ch 10, Para 4

\\newcommand{\\printSignature}{%
    \\vspace{36pt}%
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name only (abbreviated format preferred)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/mf.tex': `
%=============================================================================
%
%                   "MEMORANDUM FOR" FORMAT MODULE (USMC-SPECIFIC)
%
%=============================================================================
%
% References:
%   - MCO 5216.20B, Encl 1, Para 13.g(1)(c)
%
% What It Is:
%   A special memo format for CMC, ACMC, and DMCS signature.
%
% Key Characteristics:
%   - NO "From:" or "To:" line  just "MEMORANDUM FOR [addressee]"
%   - Signature line: 4th line below last line of text, begin at center
%   - NO complimentary close
%
% When Responding:
%   If CMC receives a "MEMORANDUM FOR" from another office, respond
%   using the same format on CMC letterhead.
%
%=============================================================================


%=============================================================================
%                    MEMORANDUM FOR ADDRESSEE
%=============================================================================
% The addressee appears after "MEMORANDUM FOR"

\\newcommand{\\MemorandumForAddressee}{}
\\newcommand{\\setMemorandumForAddressee}[1]{\\renewcommand{\\MemorandumForAddressee}{#1}}


%=============================================================================
%                    DATE/SSIC BLOCK AND MEMO TITLE
%=============================================================================
% Uses letterhead with SSIC block
% "MEMORANDUM FOR [ADDRESSEE]" instead of From:/To: lines

\\newcommand{\\printDateAndTitle}{%
    \\vspace*{0.5in}%
    \\hfill
    \\begin{tabular}[t]{@{}l@{}}
        \\ifInReplyEnabled
            {\\fontsize{5pt}{6pt}\\selectfont IN REPLY REFER TO}\\\\
        \\fi
        \\DocumentSSIC\\\\
        \\DocumentSerial\\\\
        \\DocumentDate
    \\end{tabular}\\\\[24pt]
    \\noindent MEMORANDUM FOR \\MemorandumForAddressee\\\\[12pt]
}


%=============================================================================
%                           SUBJECT BLOCK
%=============================================================================
% No From:/To: lines - just Subject

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                SIGNATURE BLOCK ("Memorandum For" Style)
%=============================================================================
% Signature line: 4th line below last line of text, begin at center
% NO complimentary close
% Per MCO 5216.20B, Encl 1, Para 13.g(1)(c)

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%  % 4 blank lines (~48pt at 12pt font)
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name (use abbreviated if available, else full name uppercased)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: Rank and Title
        \\optionalLine{\\SignatoryRank}%
        \\optionalLine{\\SignatoryTitle}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/mfr.tex': `
%=============================================================================
%
%                     MFR (MEMORANDUM FOR THE RECORD) FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 10
%   - MCO 5216.20B w/Admin CH-4 (Marine Corps Supplement)
%
% Spacing per SECNAV M-5216.5:
%   - From/To: Single-spaced, NO blank lines between them
%   - One blank line before Subj, Ref, Encl, and body paragraph 1
%
%=============================================================================


%=============================================================================
%                          DATE AND MEMO TITLE
%=============================================================================

\\newcommand{\\printDateAndTitle}{%
    \\hfill \\DocumentDate\\\\[12pt]
    \\begin{center}
        MEMORANDUM FOR THE RECORD
    \\end{center}
    \\vspace{12pt}% One blank line between title and From/To block
}


%=============================================================================
%                    FROM / TO / SUBJ BLOCK (MFR Style)
%=============================================================================

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline
        \\ifdefempty{\\ToLine}{}{To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline}
        & \\tabularnewline[-6pt]
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                       SIGNATURE BLOCK (MFR Style)
%=============================================================================

\\newcommand{\\printSignature}{%
    \\vspace{36pt}%
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name (use abbreviated if available, else full name uppercased)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: Rank and Title
        \\optionalLine{\\SignatoryRank}%
        \\optionalLine{\\SignatoryTitle}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/moa.tex': `
%=============================================================================
%
%                   MEMORANDUM OF AGREEMENT (MOA) FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 10, Para 6
%   - Figure 10-5
%
% What It's For:
%   Document mutual agreements between commands/activities regarding:
%   - Facts, Intentions, Procedures
%   - Limits on future actions
%   - Coordination (present or future)
%   - Commitments
%
% Key Rules:
%   - Paper: Senior command's letterhead (or plain bond with typed titles)
%   - Both commands include: SSIC, Serial number, Date
%   - Layout: Side by side  senior command on LEFT
%   - Title block: Centered, second line below date
%   - Signatures: Senior on RIGHT, Junior on LEFT (with overscoring)
%   - Senior signs AFTER junior
%
%=============================================================================


%=============================================================================
%                    COMMAND CONFIGURATION
%=============================================================================
% Commands are pre-defined in main.tex, format file just uses them.
% Junior command: left side, signs FIRST
% Senior command: right side, signs LAST
%
% For MOA/MOU, uses a subset of the Joint Letter fields:
%   - JuniorCommandName, JuniorSSIC, JuniorSerial, JuniorDate
%   - JuniorSignatoryName, JuniorSignatoryRank (from main.tex stubs)
%   - JuniorSignatoryTitle
%   - SeniorCommandName


%=============================================================================
%                    DUAL ID SYMBOLS AND TITLE BLOCK
%=============================================================================
% Both commands' ID symbols side by side
% Senior command on LEFT, Junior command on RIGHT
% Title block centered below

\\newcommand{\\printDateAndTitle}{%
    \\vspace*{0.5in}%
    % Dual ID symbols - side by side
    \\noindent
    \\begin{tabular}[t]{@{}p{3in}@{\\hfill}p{3in}@{}}
        % Senior command (LEFT)
        \\begin{tabular}[t]{@{}l@{}}
            \\optionalLine{\\DocumentSSIC}%
            \\optionalLine{\\DocumentSerial}%
            \\optionalField{\\DocumentDate}%
        \\end{tabular}
        &
        % Junior command (RIGHT)
        \\begin{tabular}[t]{@{}l@{}}
            \\optionalLine{\\JuniorSSIC}%
            \\optionalLine{\\JuniorSerial}%
            \\optionalField{\\JuniorDate}%
        \\end{tabular}
    \\end{tabular}
    \\par\\vspace{24pt}%
    %
    % Title block - centered
    \\begin{center}
        MEMORANDUM OF AGREEMENT\\\\
        BETWEEN\\\\
        \\ifNotEmptyElse{\\SeniorCommandName}{\\MakeUppercase{\\SeniorCommandName}\\\\}{[SENIOR COMMAND]\\\\}%
        AND\\\\
        \\ifNotEmptyElse{\\JuniorCommandName}{\\MakeUppercase{\\JuniorCommandName}}{[JUNIOR COMMAND]}%
    \\end{center}
    \\vspace{12pt}
}


%=============================================================================
%                           SUBJECT BLOCK
%=============================================================================

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                    DUAL SIGNATURE BLOCK (MOA Style)
%=============================================================================
% Junior signs on LEFT (signs first)
% Senior signs on RIGHT (signs last)
% Use overscoring (line above the name)

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%
    \\noindent
    \\begin{tabular}[t]{@{}p{3in}@{\\hfill}p{3in}@{}}
        % Junior command signature (LEFT) - signs FIRST
        \\begin{minipage}[t]{2.5in}
            \\centering
            \\rule{2in}{0.4pt}\\\\
            \\MakeUppercase{\\JuniorSignatoryName}\\\\
            \\optionalLine{\\JuniorSignatoryRank}%
            \\optionalLine{\\JuniorSignatoryTitle}%
            \\optionalField{\\JuniorByDirection}%
        \\end{minipage}
        &
        % Senior command signature (RIGHT) - signs LAST
        \\begin{minipage}[t]{2.5in}
            \\centering
            \\rule{2in}{0.4pt}\\\\
            \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
            \\optionalLine{\\SignatoryRank}%
            \\optionalLine{\\SignatoryTitle}%
            \\optionalField{\\ByDirection}%
        \\end{minipage}
    \\end{tabular}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/mou.tex': `
%=============================================================================
%
%                 MEMORANDUM OF UNDERSTANDING (MOU) FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 10, Para 6
%   - Figures 10-6 and 10-7
%
% What It's For:
%   Same as MOA  document mutual understandings between commands.
%
% Format:
%   IDENTICAL to MOA except:
%   - Title says "MEMORANDUM OF UNDERSTANDING" instead of "...AGREEMENT"
%   - Subject line says "MEMORANDUM OF UNDERSTANDING"
%
% Multi-Page MOUs:
%   - First page: ID symbols, title block, begin body
%   - Second+ pages: Repeat subject line at top; page number centered bottom
%   - Last page: Signature blocks
%
%=============================================================================


%=============================================================================
%                    COMMAND CONFIGURATION
%=============================================================================
% Commands are pre-defined in main.tex, format file just uses them.
% Junior command: left side, signs FIRST
% Senior command: right side, signs LAST
%
% For MOA/MOU, uses a subset of the Joint Letter fields:
%   - JuniorCommandName, JuniorSSIC, JuniorSerial, JuniorDate
%   - JuniorSignatoryName, JuniorSignatoryRank (from main.tex stubs)
%   - JuniorSignatoryTitle
%   - SeniorCommandName


%=============================================================================
%                    DUAL ID SYMBOLS AND TITLE BLOCK
%=============================================================================
% Both commands' ID symbols side by side
% Senior command on LEFT, Junior command on RIGHT
% Title block centered below

\\newcommand{\\printDateAndTitle}{%
    \\vspace*{0.5in}%
    % Dual ID symbols - side by side
    \\noindent
    \\begin{tabular}[t]{@{}p{3in}@{\\hfill}p{3in}@{}}
        % Senior command (LEFT)
        \\begin{tabular}[t]{@{}l@{}}
            \\optionalLine{\\DocumentSSIC}%
            \\optionalLine{\\DocumentSerial}%
            \\optionalField{\\DocumentDate}%
        \\end{tabular}
        &
        % Junior command (RIGHT)
        \\begin{tabular}[t]{@{}l@{}}
            \\optionalLine{\\JuniorSSIC}%
            \\optionalLine{\\JuniorSerial}%
            \\optionalField{\\JuniorDate}%
        \\end{tabular}
    \\end{tabular}
    \\par\\vspace{24pt}%
    %
    % Title block - centered (MOU instead of MOA)
    \\begin{center}
        MEMORANDUM OF UNDERSTANDING\\\\
        BETWEEN\\\\
        \\ifNotEmptyElse{\\SeniorCommandName}{\\MakeUppercase{\\SeniorCommandName}\\\\}{[SENIOR COMMAND]\\\\}%
        AND\\\\
        \\ifNotEmptyElse{\\JuniorCommandName}{\\MakeUppercase{\\JuniorCommandName}}{[JUNIOR COMMAND]}%
    \\end{center}
    \\vspace{12pt}
}


%=============================================================================
%                           SUBJECT BLOCK
%=============================================================================

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                    DUAL SIGNATURE BLOCK (MOU Style)
%=============================================================================
% Junior signs on LEFT (signs first)
% Senior signs on RIGHT (signs last)
% Use overscoring (line above the name)

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%
    \\noindent
    \\begin{tabular}[t]{@{}p{3in}@{\\hfill}p{3in}@{}}
        % Junior command signature (LEFT) - signs FIRST
        \\begin{minipage}[t]{2.5in}
            \\centering
            \\rule{2in}{0.4pt}\\\\
            \\MakeUppercase{\\JuniorSignatoryName}\\\\
            \\optionalLine{\\JuniorSignatoryRank}%
            \\optionalLine{\\JuniorSignatoryTitle}%
            \\optionalField{\\JuniorByDirection}%
        \\end{minipage}
        &
        % Senior command signature (RIGHT) - signs LAST
        \\begin{minipage}[t]{2.5in}
            \\centering
            \\rule{2in}{0.4pt}\\\\
            \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
            \\optionalLine{\\SignatoryRank}%
            \\optionalLine{\\SignatoryTitle}%
            \\optionalField{\\ByDirection}%
        \\end{minipage}
    \\end{tabular}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/multiple_address_letter.tex': `
%=============================================================================
%
%                   MULTIPLE-ADDRESS LETTER FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 8
%   - Figures 8-1 through 8-4
%
% What It's For:
%   Use when you have MORE THAN ONE action addressee.
%   Same as standard letter except for how addresses are handled.
%
% Three Methods:
%   1. "To:" Line Only (4 addressees) - list all in To: line
%   2. "Distribution:" Line Only (>4 addressees) - omit To:, use Distribution:
%   3. Both "To:" and "Distribution:" - group title in To:, members in Distribution:
%
% Critical Rule:
%   Every action addressee must receive a letter with:
%   1. A letterhead (printed, typed, stamped, or photocopied)
%   2. A signature (original or photocopied)
%
%=============================================================================


%=============================================================================
%                    DISTRIBUTION LIST CONFIGURATION
%=============================================================================
% SECNAV Ch 8 distinguishes between:
%   - Distribution: = ACTION addressees (who must take action)
%   - Copy to: = INFO addressees (for information only)

% Distribution list (action addressees) - for Method 2 and 3
\\newcommand{\\DistributionList}{}
\\newcommand{\\setDistribution}[1]{\\renewcommand{\\DistributionList}{#1}}

% Toggle for using Distribution line (Method 2 or 3)
\\newif\\ifDistributionEnabled
\\DistributionEnabledfalse

\\newcommand{\\enableDistribution}{\\DistributionEnabledtrue}

% Copy to list (info addressees) - separate from Distribution
\\newcommand{\\CopyToList}{}
\\newcommand{\\setCopyTo}[1]{\\renewcommand{\\CopyToList}{#1}}


%=============================================================================
%                    DATE/SSIC BLOCK
%=============================================================================

\\newcommand{\\printDateAndTitle}{%
    \\vspace*{0.5in}%
    \\hfill
    \\begin{tabular}[t]{@{}l@{}}
        \\ifInReplyEnabled
            {\\fontsize{5pt}{6pt}\\selectfont IN REPLY REFER TO}\\\\
        \\fi
        \\DocumentSSIC\\\\
        \\DocumentSerial\\\\
        \\DocumentDate
    \\end{tabular}\\\\[24pt]
}


%=============================================================================
%                    FROM / TO / VIA / SUBJ BLOCK
%=============================================================================
% Method 1: To: line with 4 addressees stacked
% Method 2: No To: line (omit), use Distribution: after signature
% Method 3: To: line with group title, Distribution: lists members

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline
        % To: line - may be omitted for Method 2
        \\ifdefempty{\\ToLine}{}{%
            To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline
        }%
        \\ifViaEnabled
            Via: & \\ViaLineOne\\ifdefempty{\\ViaLineTwo}{}{\\tabularnewline & \\ViaLineTwo}\\ifdefempty{\\ViaLineThree}{}{\\tabularnewline & \\ViaLineThree}\\ifdefempty{\\ViaLineFour}{}{\\tabularnewline & \\ViaLineFour}\\tabularnewline
        \\fi
        & \\tabularnewline[-6pt]
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                    SIGNATURE BLOCK WITH DISTRIBUTION
%=============================================================================
% Signature followed by Distribution: line (if enabled)

\\newcommand{\\printSignature}{%
    \\vspace{36pt}%
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name (use abbreviated if available, else full name uppercased)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: Rank
        \\optionalLine{\\SignatoryRank}%
        % Optional: Title
        \\optionalLine{\\SignatoryTitle}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}%
    %
    % Distribution line (for Method 2 and 3) - ACTION addressees
    \\ifDistributionEnabled
        \\par\\vspace{24pt}%
        \\noindent Distribution:\\\\
        \\DistributionList
    \\fi
    %
    % Copy to line - INFO addressees (separate from Distribution)
    \\ifNotEmpty{\\CopyToList}{%
        \\par\\vspace{24pt}%
        \\noindent Copy to:\\\\
        \\CopyToList
    }%
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/naval_letter.tex': `
%=============================================================================
%
%                     STANDARD NAVAL LETTER FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 2
%   - MCO 5216.20B w/Admin CH-4 (Marine Corps Supplement)
%
% Spacing per SECNAV M-5216.5 Figure 2-1:
%   - From/To/Via: Single-spaced, NO blank lines between them
%   - One blank line before Subj, Ref, Encl, and body paragraph 1
%
%=============================================================================


%=============================================================================
%                    SSIC / SERIAL / DATE BLOCK (Right-aligned)
%=============================================================================

\\newcommand{\\printDateAndTitle}{%
    \\begingroup
    \\raggedleft
    % Optional "IN REPLY REFER TO" line per SECNAV M-5216.5 App C, Para 1.a
    \\ifInReplyEnabled
        {\\fontsize{5pt}{6pt}\\selectfont IN REPLY REFER TO}\\\\
    \\fi
    \\ifx\\DocumentSSIC\\empty\\else
        \\DocumentSSIC\\\\
    \\fi
    \\ifx\\DocumentSerial\\empty\\else
        \\DocumentSerial\\\\
    \\fi
    \\DocumentDate\\par
    \\endgroup
}


%=============================================================================
%                    FROM / TO / VIA / SUBJ BLOCK
%=============================================================================

% SECNAV M-5216.5 spacing after colons:
%   From:  2 spaces    To:    6 spaces    Via:   5 spaces
%   Subj:  3 spaces    Ref:   4 spaces    Encl:  3 spaces
%
% Second column width: 5.75in to respect 1" right margin
% (textwidth=6.5in minus ~0.75in for labels)
\\makeatletter
\\newcommand{\\printAddressBlock}{%
    \\begingroup
    \\singlespacing
    \\noindent
    % Build Via rows into a macro before the tabular
    \\def\\@viarows{}%
    \\ifViaEnabled
        \\def\\@viarows{\\tabularnewline Via:\\hspace{5\\fontdimen2\\font} & \\ViaLineOne}%
        \\ifdefempty{\\ViaLineTwo}{}{\\appto\\@viarows{\\tabularnewline & \\ViaLineTwo}}%
        \\ifdefempty{\\ViaLineThree}{}{\\appto\\@viarows{\\tabularnewline & \\ViaLineThree}}%
        \\ifdefempty{\\ViaLineFour}{}{\\appto\\@viarows{\\tabularnewline & \\ViaLineFour}}%
    \\fi
    \\begin{tabular}[t]{@{}l@{}p{5.75in}@{}}%
        From:\\hspace{2\\fontdimen2\\font} & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline%
        To:\\hspace{6\\fontdimen2\\font} & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}%
        \\@viarows
        \\tabularnewline[12pt]%
        Subj:\\hspace{3\\fontdimen2\\font} & \\SubjectLine%
    \\end{tabular}%
    \\endgroup
    %
    % CUI block
    \\ifCUIEnabled
        \\par\\vspace{12pt}
        \\noindent Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\par\\vspace{12pt}
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\par\\vspace{12pt}
        \\noindent Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}
\\makeatother


%=============================================================================
%                  SIGNATURE BLOCK (Naval Letter Style)
%=============================================================================
% SECNAV M-5216.5 Ch 7, Para 14.a:
%   - Position: Center of page, fourth line below text
%   - Format: First initial, middle initial, LAST NAME (caps)
%   - Example: J. M. SMITH
%   - No rank, no complimentary close
%
% Use \\setSignatoryAbbrev{J. M. SMITH} in config/signatory.tex

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%  % 4 blank lines below text per SECNAV Ch 7, Para 14
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Use abbreviated format (J. M. LASTNAME) if set, otherwise full name
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: By direction authority line (e.g., "By direction")
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================
% SECNAV M-5216.5 Ch 7, Para 17:
%   - First page: Do NOT number
%   - Second+ pages: Start with "2", centered, " from bottom
%   - No punctuation (just the number)

\\fancypagestyle{firstpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{}%  % No page number on first page
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\thepage}%  % Just the number, no "of X"
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/new_page_endorsement.tex': `
%=============================================================================
%
%                   NEW-PAGE ENDORSEMENT FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 9
%   - Figure 9-3
%
% What It's For:
%   Use an endorsement to forward comments, recommendations, or
%   information when correspondence is transmitted via your activity.
%
% When to Use New-Page:
%   - Endorsement won't fit on previous page
%   - MUST include SSIC, endorsement line identifying basic letter,
%     and use basic letter's subject
%
% Key Rules:
%   - Uses command letterhead
%   - SSIC required
%   - Subject line repeats basic letter's subject
%   - DO NOT repeat references already in basic letter
%   - DO NOT repeat enclosures already in basic letter
%   - Continue numbering sequences from basic letter
%   - Page number continues from basic letter
%
%=============================================================================


%=============================================================================
%                    ENDORSEMENT CONFIGURATION
%=============================================================================

\\newcommand{\\EndorsementOrdinal}{}      % FIRST, SECOND, THIRD, etc.
\\newcommand{\\BasicLetterID}{}           % e.g., "NAS Meridian ltr 5216 Ser 11/273 of 22 Apr 15"

\\newcommand{\\setEndorsement}[2]{%
    \\renewcommand{\\EndorsementOrdinal}{#1}%
    \\renewcommand{\\BasicLetterID}{#2}%
}


%=============================================================================
%                    DATE/SSIC BLOCK AND ENDORSEMENT LINE
%=============================================================================
% Uses letterhead with SSIC block
% Endorsement line: "[ORDINAL] ENDORSEMENT on [basic letter ID]"
% Position: Left margin, 2nd line below date line

\\newcommand{\\printDateAndTitle}{%
    \\vspace*{0.5in}%
    \\hfill
    \\begin{tabular}[t]{@{}l@{}}
        \\ifInReplyEnabled
            {\\fontsize{5pt}{6pt}\\selectfont IN REPLY REFER TO}\\\\
        \\fi
        \\DocumentSSIC\\\\
        \\DocumentSerial\\\\
        \\DocumentDate
    \\end{tabular}\\\\[24pt]
    \\noindent\\MakeUppercase{\\EndorsementOrdinal} ENDORSEMENT on \\BasicLetterID\\\\[12pt]
}


%=============================================================================
%                    FROM / TO / VIA / SUBJ BLOCK
%=============================================================================
% Subject line REQUIRED - repeats basic letter's subject
% Via line only shows REMAINING addressees

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline
        To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline
        \\ifViaEnabled
            Via: & \\ViaLineOne\\ifdefempty{\\ViaLineTwo}{}{\\tabularnewline & \\ViaLineTwo}\\ifdefempty{\\ViaLineThree}{}{\\tabularnewline & \\ViaLineThree}\\ifdefempty{\\ViaLineFour}{}{\\tabularnewline & \\ViaLineFour}\\tabularnewline
        \\fi
        & \\tabularnewline[-6pt]
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                    SIGNATURE BLOCK
%=============================================================================
% Name only OR with "By direction"

\\newcommand{\\printSignature}{%
    \\vspace{36pt}%
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name only (abbreviated format preferred)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================
% Page number continues from basic letter

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\thepage}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/plain_paper_memorandum.tex': `
%=============================================================================
%
%                     PLAIN-PAPER MEMORANDUM FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 10, Para 3
%   - Figure 10-3
%
% What It's For:
%   Informal internal correspondence  more flexible than printed form
%   when you have multiple addressees or via addressees.
%
% Requirements:
%   - Paper: White bond (NO letterhead)
%   - Date: 6th line from top, flush RIGHT margin
%   - ID symbols: Date only (unless local practice requires more)
%   - Signature: Name only  full signature line NOT required
%
%=============================================================================


%=============================================================================
%                          DATE AND MEMO TITLE
%=============================================================================
% Date on line 6, right margin
% "MEMORANDUM" at left margin (not "MEMORANDUM FOR THE RECORD")

\\newcommand{\\printDateAndTitle}{%
    \\hfill \\DocumentDate\\\\[12pt]
    \\noindent MEMORANDUM\\\\[12pt]
}


%=============================================================================
%              FROM / TO / VIA / SUBJ BLOCK (Plain-Paper Style)
%=============================================================================
% - From: line with sender
% - To: line with primary addressee (additional addressees aligned below)
% - Via: line (if applicable)
% - Subj: in ALL CAPS

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline
        To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline
        \\ifViaEnabled
            Via: & \\ViaLineOne\\ifdefempty{\\ViaLineTwo}{}{\\tabularnewline & \\ViaLineTwo}\\ifdefempty{\\ViaLineThree}{}{\\tabularnewline & \\ViaLineThree}\\ifdefempty{\\ViaLineFour}{}{\\tabularnewline & \\ViaLineFour}\\tabularnewline
        \\fi
        & \\tabularnewline[-6pt]
        Subj: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\\\[12pt]%
        \\noindent
        Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}


%=============================================================================
%                  SIGNATURE BLOCK (Plain-Paper Memo Style)
%=============================================================================
% Signature is name only  NO rank, NO organizational title
% Per SECNAV Ch 10, Para 3

\\newcommand{\\printSignature}{%
    \\vspace{36pt}%
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name only (abbreviated format preferred)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                         LETTERHEAD OVERRIDE
%=============================================================================
% Plain-paper memo does NOT use letterhead

\\renewcommand{\\printLetterhead}{}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/same_page_endorsement.tex': `
%=============================================================================
%
%                   SAME-PAGE ENDORSEMENT FORMAT MODULE
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 9
%   - Figures 9-1, 9-2
%
% What It's For:
%   Use an endorsement to forward comments, recommendations, or
%   information when correspondence is transmitted via your activity.
%
% When to Use Same-Page:
%   - Endorsement completely fits on signature page of basic letter
%     or preceding endorsement
%   - May omit SSIC, subject, and basic letter's ID symbols if
%     entire page will be photocopied
%
% Key Rules:
%   - Horizontal line separates basic letter from endorsement
%   - DO NOT repeat references already in basic letter
%   - DO NOT repeat enclosures already in basic letter
%   - Continue numbering sequences from basic letter
%
%=============================================================================


%=============================================================================
%                    ENDORSEMENT CONFIGURATION
%=============================================================================

\\newcommand{\\EndorsementOrdinal}{}      % FIRST, SECOND, THIRD, etc.
\\newcommand{\\EndorsementSerial}{}       % Ser XXX/### (for same-page, often omitted)
\\newcommand{\\EndorsementDate}{}         % Date of endorsement
\\newcommand{\\BasicLetterID}{}           % Basic letter identification (optional for same-page)

\\newcommand{\\setEndorsement}[3]{%
    \\renewcommand{\\EndorsementOrdinal}{#1}%
    \\renewcommand{\\EndorsementSerial}{#2}%
    \\renewcommand{\\EndorsementDate}{#3}%
}

% Set basic letter ID (e.g., "USS SCRANTON ltr 3000 Ser SSN 756/001 of 5 May 96")
\\newcommand{\\setBasicLetterID}[1]{\\renewcommand{\\BasicLetterID}{#1}}


%=============================================================================
%                    ENDORSEMENT LINE AND DATE
%=============================================================================
% Same-page endorsement starts with horizontal rule
% May omit SSIC, subject, and basic letter ID (entire page photocopied)

\\newcommand{\\printDateAndTitle}{%
    \\vspace{24pt}%
    \\noindent\\rule{\\textwidth}{0.4pt}\\\\[12pt]%
    \\hfill
    \\begin{tabular}[t]{@{}l@{}}
        \\ifdefempty{\\EndorsementSerial}{}{%
            \\EndorsementSerial\\\\
        }%
        \\EndorsementDate
    \\end{tabular}\\\\[12pt]
    % Endorsement line - include basic letter ID if provided
    \\noindent\\MakeUppercase{\\EndorsementOrdinal} ENDORSEMENT%
    \\ifdefempty{\\BasicLetterID}{}{ on \\BasicLetterID}%
    \\\\[12pt]
}


%=============================================================================
%                    FROM / TO / VIA BLOCK
%=============================================================================
% Via line only shows REMAINING addressees
% If only one Via remains, do NOT number it
% If more than one remains, number starting with (1), (2), etc.

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        From: & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline
        To: & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}\\tabularnewline
        \\ifViaEnabled
            Via: & \\ViaLineOne\\ifdefempty{\\ViaLineTwo}{}{\\tabularnewline & \\ViaLineTwo}\\ifdefempty{\\ViaLineThree}{}{\\tabularnewline & \\ViaLineThree}\\ifdefempty{\\ViaLineFour}{}{\\tabularnewline & \\ViaLineFour}\\tabularnewline
        \\fi
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
}


%=============================================================================
%                    SIGNATURE BLOCK
%=============================================================================
% Name only OR with "By direction"

\\newcommand{\\printSignature}{%
    \\vspace{36pt}%
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name only (abbreviated format preferred)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                         LETTERHEAD OVERRIDE
%=============================================================================
% Same-page endorsement does NOT use new letterhead (on same page)

\\renewcommand{\\printLetterhead}{}


%=============================================================================
%                              PAGE STYLE
%=============================================================================

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\smartPageNumber}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/standard_letter.tex': `
%=============================================================================
%
%                 STANDARD LETTER FORMAT MODULE (Plain Bond Paper)
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 2, Para 1.c.(1)
%   - MCO 5216.20B w/Admin CH-4 (Marine Corps Supplement)
%
% Use this format for:
%   - Personal matters to higher authority (IG complaints, retirement requests)
%   - Individual correspondence outside your activity
%   - When command letterhead is NOT authorized
%
% Key differences from Naval Letter:
%   - NO letterhead (plain white bond paper)
%   - From: line = YOUR name, rank, service (not activity head title)
%   - Via: typically used for routing through chain of command
%   - Serial number optional (unless classified)
%
% Spacing per SECNAV M-5216.5 Figure 2-1:
%   - From/To/Via: Single-spaced, NO blank lines between them
%   - One blank line before Subj, Ref, Encl, and body paragraph 1
%
%=============================================================================


%=============================================================================
%                    SSIC / SERIAL / DATE BLOCK (Right-aligned)
%=============================================================================
% For personal correspondence:
%   - SSIC: Optional (include if applicable)
%   - Serial: Optional (unless classified)
%   - Date: Required

\\newcommand{\\printDateAndTitle}{%
    \\begingroup
    \\raggedleft
    % Optional "IN REPLY REFER TO" line per SECNAV M-5216.5 App C, Para 1.a
    \\ifInReplyEnabled
        {\\fontsize{5pt}{6pt}\\selectfont IN REPLY REFER TO}\\\\
    \\fi
    \\ifx\\DocumentSSIC\\empty\\else
        \\DocumentSSIC\\\\
    \\fi
    \\ifx\\DocumentSerial\\empty\\else
        \\DocumentSerial\\\\
    \\fi
    \\DocumentDate\\par
    \\endgroup
}


%=============================================================================
%              NO LETTERHEAD - Override \\printLetterhead
%=============================================================================
% SECNAV M-5216.5 Ch 2, Para 1.c.(1):
%   "Use plain bond paper for personal correspondence"
%
% This format uses plain white bond paper - no DoD seal, no unit name.

\\renewcommand{\\printLetterhead}{%
    % No letterhead - plain bond paper
    % Just add some top spacing where letterhead would normally be
    \\vspace*{0.5in}%
}


%=============================================================================
%                    FROM / TO / VIA / SUBJ BLOCK
%=============================================================================
% SECNAV M-5216.5 Ch 2, Para 1.c.(1):
%   From: line = YOUR name, rank, service
%   May include unit, contact info on continuation lines
%
% SECNAV M-5216.5 spacing after colons:
%   From:  2 spaces    To:    6 spaces    Via:   5 spaces
%   Subj:  3 spaces    Ref:   4 spaces    Encl:  3 spaces
%
% Second column width: 5.75in to respect 1" right margin
% (textwidth=6.5in minus ~0.75in for labels)
\\makeatletter
\\newcommand{\\printAddressBlock}{%
    \\begingroup
    \\singlespacing
    \\noindent
    % Build Via rows into a macro before the tabular
    \\def\\@viarows{}%
    \\ifViaEnabled
        \\def\\@viarows{\\tabularnewline Via:\\hspace{5\\fontdimen2\\font} & \\ViaLineOne}%
        \\ifdefempty{\\ViaLineTwo}{}{\\appto\\@viarows{\\tabularnewline & \\ViaLineTwo}}%
        \\ifdefempty{\\ViaLineThree}{}{\\appto\\@viarows{\\tabularnewline & \\ViaLineThree}}%
        \\ifdefempty{\\ViaLineFour}{}{\\appto\\@viarows{\\tabularnewline & \\ViaLineFour}}%
    \\fi
    \\begin{tabular}[t]{@{}l@{}p{5.75in}@{}}%
        From:\\hspace{2\\fontdimen2\\font} & \\FromLine\\ifdefempty{\\FromLineTwo}{}{\\tabularnewline & \\FromLineTwo}\\ifdefempty{\\FromLineThree}{}{\\tabularnewline & \\FromLineThree}\\ifdefempty{\\FromLineFour}{}{\\tabularnewline & \\FromLineFour}\\tabularnewline%
        To:\\hspace{6\\fontdimen2\\font} & \\ToLine\\ifdefempty{\\ToLineTwo}{}{\\tabularnewline & \\ToLineTwo}\\ifdefempty{\\ToLineThree}{}{\\tabularnewline & \\ToLineThree}\\ifdefempty{\\ToLineFour}{}{\\tabularnewline & \\ToLineFour}%
        \\@viarows
        \\tabularnewline[12pt]%
        Subj:\\hspace{3\\fontdimen2\\font} & \\SubjectLine%
    \\end{tabular}%
    \\endgroup
    %
    % CUI block
    \\ifCUIEnabled
        \\par\\vspace{12pt}
        \\noindent Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\par\\vspace{12pt}
        \\noindent\\CUIDistStatement
    \\fi
    %
    % Classified block
    \\ifClassifiedEnabled
        \\par\\vspace{12pt}
        \\noindent Classified by: \\ClassifiedBy\\\\
        Derived from: \\DerivedFrom\\\\
        Reason: \\ClassificationReason\\\\
        Declassify on: \\DeclassifyOn\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}
    \\fi
}
\\makeatother


%=============================================================================
%                  SIGNATURE BLOCK (Standard Letter Style)
%=============================================================================
% SECNAV M-5216.5 Ch 7, Para 14.a:
%   - Position: Center of page, fourth line below text
%   - Format: First initial, middle initial, LAST NAME (caps)
%   - Example: J. A. SMITH
%   - No rank, no complimentary close
%
% Use \\setSignatoryAbbrev{J. A. SMITH} in config/signatory.tex

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%  % 4 blank lines below text per SECNAV Ch 7, Para 14
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Use abbreviated format (J. M. LASTNAME) if set, otherwise full name
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}
}


%=============================================================================
%                              PAGE STYLE
%=============================================================================
% SECNAV M-5216.5 Ch 7, Para 17:
%   - First page: Do NOT number
%   - Second+ pages: Start with "2", centered, 1/2" from bottom
%   - No punctuation (just the number)

\\fancypagestyle{firstpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{}%  % No page number on first page
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\thepage}%  % Just the number, no "of X"
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
  'tex/templates/standard_memorandum.tex': `
%=============================================================================
%
%                   STANDARD MEMORANDUM FORMAT MODULE
%                        (Executive - HqDON/OSD)
%
%=============================================================================
%
% References:
%   - SECNAV M-5216.5 (DON Correspondence Manual), Chapter 12, Para 12-4
%
% What It's For:
%   Executive correspondence for HqDON, DoD, and White House.
%
% Key Characteristics:
%   - Font: Times New Roman, 12-point (NOT Courier)
%   - Margins: 2" top first page, 1" all other sides
%   - "MEMORANDUM FOR [addressee]" - NO From:/To: lines
%   - NO salutation, NO complimentary close
%   - Signature block: 4 blank lines below text, begin at center
%   - First page NOT numbered
%
%=============================================================================


%=============================================================================
%                         FONT OVERRIDE
%=============================================================================
% Executive memos use Times New Roman, not Courier

\\renewcommand{\\familydefault}{\\rmdefault}
\\usepackage{times}


%=============================================================================
%                    MEMORANDUM FOR ADDRESSEE
%=============================================================================

\\newcommand{\\MemorandumForAddressee}{}
\\newcommand{\\setMemorandumForAddressee}[1]{\\renewcommand{\\MemorandumForAddressee}{#1}}


%=============================================================================
%                    DISTRIBUTION LIST (for 16+ addressees)
%=============================================================================

\\newcommand{\\DistributionList}{}
\\newcommand{\\setDistribution}[1]{\\renewcommand{\\DistributionList}{#1}}

\\newif\\ifDistributionEnabled
\\DistributionEnabledfalse
\\newcommand{\\enableDistribution}{\\DistributionEnabledtrue}


%=============================================================================
%                    DATE AND MEMO TITLE
%=============================================================================
% Date at right, "MEMORANDUM FOR" double space below

\\newcommand{\\printDateAndTitle}{%
    \\vspace*{1in}%  % 2" top margin (1" from geometry + 1" here)
    \\hfill \\DocumentDate\\\\[24pt]
    \\ifDistributionEnabled
        \\noindent MEMORANDUM FOR: SEE DISTRIBUTION\\\\[12pt]
    \\else
        \\noindent MEMORANDUM FOR \\MemorandumForAddressee\\\\[12pt]
    \\fi
}


%=============================================================================
%                           SUBJECT BLOCK
%=============================================================================

\\newcommand{\\printAddressBlock}{%
    \\noindent
    \\begin{tabular}[t]{@{}l@{\\hspace{1em}}p{5.5in}@{}}
        SUBJECT: & \\SubjectLine\\tabularnewline
    \\end{tabular}%
    %
    % CUI block
    \\ifCUIEnabled
        \\\\[12pt]%
        \\noindent
        Controlled by: \\CUIControlledBy\\\\
        CUI Category: \\CUICategory\\\\
        Limited Dissemination Control: \\CUIDissemination\\\\
        POC: \\href{mailto:\\POCEmail}{\\POCEmail}%
        \\\\[12pt]%
        \\noindent\\CUIDistStatement
    \\fi
}


%=============================================================================
%                SIGNATURE BLOCK (Executive Style)
%=============================================================================
% 4 blank lines below text, begin at center
% NO complimentary close

\\newcommand{\\printSignature}{%
    \\vspace{48pt}%  % 4 blank lines
    \\hspace{3.25in}%
    \\begin{minipage}{3in}
        \\raggedright
        % Optional: Signature image
        \\ifNotEmpty{\\SignatureImage}{%
            \\IfFileExists{attachments/\\SignatureImage}{%
                \\includegraphics[width=1.5in,height=0.5in,keepaspectratio]{attachments/\\SignatureImage}\\\\[6pt]%
            }{}%
        }%
        % Required: Name (use abbreviated if available, else full name uppercased)
        \\ifNotEmptyElse{\\SignatoryAbbrev}{\\SignatoryAbbrev\\\\}{\\MakeUppercase{\\SignatoryName}\\\\}%
        % Optional: Title
        \\optionalLine{\\SignatoryTitle}%
        % Optional: By direction authority line
        \\optionalField{\\ByDirection}%
    \\end{minipage}%
    %
    % Distribution list (if 16+ addressees)
    \\ifDistributionEnabled
        \\vspace{24pt}%

        \\noindent DISTRIBUTION:\\\\
        \\DistributionList
    \\fi
}


%=============================================================================
%                         LETTERHEAD OVERRIDE
%=============================================================================
% Executive memos may or may not use letterhead

\\renewcommand{\\printLetterhead}{}


%=============================================================================
%                              PAGE STYLE
%=============================================================================
% First page: NOT numbered
% Succeeding pages: bottom center OR 1" from top at right

\\fancypagestyle{firstpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}

\\fancypagestyle{documentpage}{%
    \\fancyhf{}%
    \\fancyhead[C]{\\placeClassificationMarkings}%
    \\fancyfoot[C]{\\thepage}%
    \\renewcommand{\\headrulewidth}{0pt}%
    \\renewcommand{\\footrulewidth}{0pt}%
}
`,
};

// Export for use in app.js
if (typeof window !== 'undefined') {
  window.LATEX_TEMPLATES = LATEX_TEMPLATES;
}
